<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/blog/blog/rss.xml" title="李志华的博客 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/blog/atom.xml" title="李志华的博客 Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-478GETJ8M8","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<script async src="https://hm.baidu.com/hm.js?6cf455aa46dc50a069ab28ba6ecbf4ce"></script><title data-react-helmet="true">通过 Docker 安装 Sonatype Nexus Repository Manager | 李志华的博客</title><meta data-react-helmet="true" property="og:url" content="https://dear-lizhihua.github.io/blog/docs//blog/docs/linux/docker_install_sonatype_nexus_repository_manager"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="通过 Docker 安装 Sonatype Nexus Repository Manager | 李志华的博客"><meta data-react-helmet="true" name="description" content="重要声明"><meta data-react-helmet="true" property="og:description" content="重要声明"><link data-react-helmet="true" rel="shortcut icon" href="/blog/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://dear-lizhihua.github.io/blog/docs//blog/docs/linux/docker_install_sonatype_nexus_repository_manager"><link data-react-helmet="true" rel="alternate" href="https://dear-lizhihua.github.io/blog/docs//blog/docs/linux/docker_install_sonatype_nexus_repository_manager" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dear-lizhihua.github.io/blog/docs//blog/docs/linux/docker_install_sonatype_nexus_repository_manager" hreflang="x-default"><link rel="stylesheet" href="/blog/assets/css/styles.1a90c8a2.css">
<link rel="preload" href="/blog/assets/js/runtime~main.59631cfa.js" as="script">
<link rel="preload" href="/blog/assets/js/main.cdfbdb9d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog/"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">李志华的博客</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/docs">文档</a><a class="navbar__item navbar__link" href="/blog/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="http://netsysd.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>大众光明导航<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/blog/blog/change-log">更新日志</a><a class="navbar__item navbar__link" href="/blog/docs/translations/babel">Babel 文档</a><a class="navbar__item navbar__link" href="/blog/docs/translations/rollup">Rollup 文档</a><a href="https://github.com/dear-lizhihua" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/blog/"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">李志华的博客</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog/docs">文档</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/blog">博客</a></li><li class="menu__list-item"><a href="http://netsysd.com/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>大众光明导航<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a class="menu__link" href="/blog/blog/change-log">更新日志</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/docs/translations/babel">Babel 文档</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/docs/translations/rollup">Rollup 文档</a></li><li class="menu__list-item"><a href="https://github.com/dear-lizhihua" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/blog/docs/">介绍</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">资本主义之恶</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/capitalism/capitalist_mayun">我对资本家马云的认识和批判</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/capitalism/blessing_guys_is_very_bad">福娃们目无法纪，是劳动者中道德败坏的典型代表</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/capitalism/ele_is_very_bad">发生在我身上的饿了么之恶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/capitalism/ugly_side_of_capitalist">中国大资本家和其奴役的小资产阶级的丑态</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/capitalism/ugly_side_of_largest_chinese_companies">中国大型软件公司的丑态</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">共产主义之光</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/communism/volksbright">大众光明成立了</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/communism/2021.05.04">社会主义下青年的身份认同</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/communism/mohrss_and_ilo">人力资源社会保障部正在和国际劳工组织合作</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">哲学思考</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/idea/compare_idea">几种思想的比较：古希腊哲学、古印度佛学、现代中国共产主义</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/work/955.wlb">如何才能找到工作生活平衡(Work-Life Balance)的工作呢？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/work/a_new_company">新公司，新思考</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/simple">编程的一些简单思考</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/knowledge">知识的组织和筛选</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/resume">如何编写简历</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/design_a_cli">设计一个命令行工具，实现初始化项目</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">审视自我</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/examine_closely/principles">原则</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/examine_closely/we_can_and_we_cannot">我们能做的和我们不能做的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/examine_closely/good_learning_methods_tree_structure_of_knowledge">好的学习方式：知识点呈现为树结构</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">精读</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/index">精读系列</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/luoxiang">罗翔读书日分享</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/fighting_against_the_bookishness_original_text">反对本本主义 毛泽东</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/fighting_against_the_bookishness">反对本本主义精学导读 第一遍</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/the_grass_is_singing">野草在歌唱</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/the_grass_is_singing_01">野草在歌唱 第一章</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/intensive_reading/the_grass_is_singing_people_profile">野草在歌唱 人物资料</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">定义</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/definition/what_is_last_period_and_same_period_last_year">什么是环比和同比？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/thought/definition/product_lifecycle">产品生命周期</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">业务核心技能 (云业务)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/service_architecture">服务架构</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/cloud_platform_service_architecture">云平台服务架构</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/what_is_loading_balancing">什么是负载均衡？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/cloud_concepts">云的概念</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_platform">谷歌云平台业务介绍</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_platform_glossary">谷歌云平台术语</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_associate_cloud_engineer_exam_certification">谷歌助理云工程师（通过考试）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_associate_cloud_engineer_note">谷歌助理云工程师（笔记）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_training">谷歌云培训</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_training_cloud_iam_base">Cloud IAM 基础 - RBAC 和 ABAC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_training_cloud_iam_note">谷歌云培训 - Cloud IAM 基本概念和用法（笔记）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_training_cloud_iam_custom_roles">谷歌云培训 - Cloud IAM 自定义角色（中文）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/google_cloud_training_cloud_iam_custom_roles_en">谷歌云培训 - Cloud IAM 自定义角色（英文）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/understanding_the_google_cloud_network_edge">名称无关紧要，重要的是理解谷歌云网络边缘</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/how_to_buy_a_cloud_computing_service">选购一个云计算服务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/how_to_config_a_cloud_service">配置一个云服务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/how_to_create_a_cluster_in_mongodb_atlas">如何在 MongoDB Atlas 创建一个集群</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/how_to_create_a_nest_application">如何创建一个 Nest 应用程序</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/http/http_client">浏览器扮演的角色：HTTP 客户端</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">核心技能 (JavaScript)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/packages/index">理解 packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/compile/index">理解 compile 和 compiler</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/application/index">理解 application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/version_control/index">理解 Version Control(版本控制)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/detail/index">JavaScript 细节</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">核心技能 (Vue 2)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/vue/vue2/vue2_catch_error">Vue 2 捕获错误</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">核心技能 (Vue 3)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/vue/vue3/index">学习 Vue 3</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">核心技能 (Vite)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/vue/vite/index">Vite 构建</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">核心技能 (English)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/english/index">学习英语</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">扩展技能 (Node.js)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/extension/node_js/index">Node.js 基础</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/server/how_to_build_a_hello_world_application_with_koa">使用 Koa 构建一个 hello world 应用程序</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/server/how_to_create_interactive_command_line_prompts_with_inquirer_js">如何使用 Inquirer.js 创建交互式命令行提示</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/server/how_to_handle_command_line_arguments_in_node_js_scripts">如何处理 Node.js scripts 中的命令行参数</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">扩展技能 (安全)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/extension/security/index">安全</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">扩展技能 (Linux)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/config_docker">配置 Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/docker_install_debian">通过 Docker 安装 Debian 10</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/docker_install_centos">通过 Docker 安装 CentOS 8</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/docker_install_mariadb_and_mysql">通过 Docker 安装 MariaDB 和 MySQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/docker_install_redis">通过 Docker 安装 Redis</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/blog/docs/linux/docker_install_sonatype_nexus_repository_manager">通过 Docker 安装 Sonatype Nexus Repository Manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/docker_install_yapi">通过 Docker 安装 yapi</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/debian_10_install_nginx">Debian 10 安装 Nginx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/debian_10_install_docker">Debian 10 安装 Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/debian_10_install_package">Debian 10 安装 package</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/debian_10_install_node_npm_yarn">Debian 10 安装 Node.js, npm, yarn</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/debian_10_install_sqlite_3">Debian 10 安装 SQLite 3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/install_zsh">安装 zsh 和 oh-my-zsh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/use_ssh_to_connect_a_remote_server">使用 SSH 连接到远程服务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/use_ssh_to_connect_a_remote_server_permissions_problem">使用 SSH 连接到远程服务遇到的权限问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_google_cloud_sdk">macOS 安装 Google Cloud SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_brew">macOS 安装 brew</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_macports">macOS 安装 MacPorts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_node_js">macOS 安装 Node.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_python_3">macOS 安装 Python 3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_nvm">macOS 安装 nvm，通过 nvm 管理 Node.js 版本</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_nrm">macOS 安装 nrm，通过 nrm 管理 npm registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_git">macOS 安装 Git</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_rime">macOS 安装 Rime 输入法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/macos_install_tree">macOS 安装 tree</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/linux/why_docker_install_debian10_and_debian10_install_docker">为什么要写 `Docker 安装 Debian 10` 和 `Debian 10 安装 Docker`？</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">边缘技能 (JavaScript)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/edge/visualization/index">理解可视化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/edge/optimize/index">理解优化</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">边缘技能 (Python)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/python/python_learn_0">准备阶段</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/python/python_learn_1">字符串、变量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/python/python_learn_2">数</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">翻译</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/translations/index">JavaScript 细节</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/translations/babel">翻译 Babel 7 文档</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/translations/rollup">翻译 Rollup 文档</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/cloud/what_is_loading_balancing">什么是负载均衡？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/detail/property_order_is_predictable_in_javascript_objects_since_es2015">从 ES2015 开始，JavaScript 对象属性顺序变得可以预测</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/detail/what_is_the_tojson_function_in_javascript">JavaScript 中的 toJSON() 函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/detail/cheat_sheet_javascript_array_methods">Cheat sheet: JavaScript 数组方法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/server/how_to_build_a_hello_world_application_with_koa">使用 Koa 构建一个 hello world 应用程序</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/server/how_to_create_interactive_command_line_prompts_with_inquirer_js">如何使用 Inquirer.js 创建交互式命令行提示</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/core/server/how_to_handle_command_line_arguments_in_node_js_scripts">如何处理 Node.js scripts 中的命令行参数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/hiking_workouts_arent_just_good_for_your_body_theyre_good_for_your_mind_too">远足锻炼不仅有益于身体健康，也对有益于你的头脑</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">快乐和激情</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/happiness_and_passion">快乐和激情系列</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/hiking_workouts_arent_just_good_for_your_body_theyre_good_for_your_mind_too">远足锻炼不仅有益于身体健康，也对有益于你的头脑</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/game/how_to_become_a_farmer">在摩尔庄园成为一个农民</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.05.03">2021.05.03 武功山：发云界-龙山村</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.05.02">2021.05.02 武功山：吊马桩-发云界</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.05.01">2021.05.01 武功山：沈子村-吊马桩</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.03.27">2021.03.27 京西古道</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.03.13">2021.03.13 香八拉</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.02.27">2021.02.27 铁驼山</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.02.21">2021.02.21 天泉寺+滴水岩</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2021.02.12">2021.02.12 大年初一，京郊活动</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2018.06.16">2018.06.16 五台山</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2018.06.09">2018.06.09 五台山</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2017.06.21">2017.06.21 古北水镇和司马台长城</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2017.04.29">2017.04.29 南太行</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blog/docs/happiness_and_passion/hiking_workout/play_2016.08.13">2016.08.13 五台山</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">通过 Docker 安装 Sonatype Nexus Repository Manager</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="重要声明"></a>重要声明<a class="hash-link" href="#重要声明" title="Direct link to heading">#</a></h2><p><strong>2021.04.27</strong></p><p>发现这篇文章 <a href="https://zhuanlan.zhihu.com/p/88803943" target="_blank" rel="noopener noreferrer">Docker 安装 nexus3</a> 讲到创建后台式容器，新增后台式容器章节。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="运行容器"></a>运行容器<a class="hash-link" href="#运行容器" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="拉取镜像"></a><strong>拉取镜像</strong><a class="hash-link" href="#拉取镜像" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker pull sonatype/nexus3</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="如何配置持久化数据？"></a>如何配置持久化数据？<a class="hash-link" href="#如何配置持久化数据？" title="Direct link to heading">#</a></h3><p>参考 <a href="https://hub.docker.com/r/sonatype/nexus3" target="_blank" rel="noopener noreferrer">Docker - sonatype/nexus3</a> Persistent Data 章节。</p><blockquote><p>将宿主机目录挂载为 volume。依赖主机上有权限的已有目录。但是，在需要将该卷分配给某些特定基础存储的某些情况下，此方法很有用。</p></blockquote><p>我们可以<strong>在启动容器之前，将宿主机目录挂载到容器目录</strong>，实现持久化数据。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 这个配置很重要 -v /home/architecture/nexus-data:/nexus-data</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker run -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">8081</span><span class="token plain">:8081 --name nexus -v /home/architecture/nexus-data:/nexus-data sonatype/nexus3</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="如何配置后台式容器？"></a>如何配置后台式容器？<a class="hash-link" href="#如何配置后台式容器？" title="Direct link to heading">#</a></h3><p>通过 <code>-i</code>, <code>-d</code>, <code>--privileged=true</code>, <code>--restart=always</code>，我们创建一个可交互的守护容器，并且在重启虚拟机实例后自动重启容器。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker run -id --privileged</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">nexus3 --restart</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">always -p </span><span class="token number" style="color:rgb(247, 140, 108)">8081</span><span class="token plain">:8081 -v /home/architecture/nexus-data:/nexus-data sonatype/nexus3</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>查询 <a href="https://docs.docker.com/engine/reference/commandline/run/" target="_blank" rel="noopener noreferrer">docker run</a> 文档，可以了解到这些参数的详细解释：</p><table><thead><tr><th>参数含义</th><th>官方文档解释</th><th>我的注释</th></tr></thead><tbody><tr><td>--interactive, -i</td><td>Keep STDIN open even if not attached(即使未连接，也要保持 STDIN(标准输入) 打开)</td><td>-</td></tr><tr><td>--detach, -d</td><td>Run container in background and print container ID(在后台运行容器，并且打印容器 ID)</td><td>d 的语义不是 daemon(守护) 而是 detach(派遣)</td></tr><tr><td>--privileged=true</td><td>Give extended privileges to this container(赋予容器扩展的特权)</td><td>授予 root 权限（挂载多级目录必须为 true，否则容器访问宿主机权限不足）</td></tr><tr><td><a href="https://docs.docker.com/engine/reference/commandline/run/#restart-policies---restart" target="_blank" rel="noopener noreferrer">--restart=always</a></td><td>Restart policy to apply when a container exits(在进程退出时，使用的重启策略)</td><td>用于实现重启虚拟机实例后自动重启容器</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="运行-nexus-容器"></a><strong>运行 Nexus 容器</strong><a class="hash-link" href="#运行-nexus-容器" title="Direct link to heading">#</a></h3><p>把上面 <code>如何配置持久化数据</code> 和 <code>如何配置后台式容器</code> 两个章节结合起来，我们运行一个容器。</p><p><strong>注意</strong>：这里要使用 <code>chown -R 200</code>，添加访问 <code>/home/architecture/nexus-data</code> 路径的权限。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /home/architecture/nexus-data </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">chown</span><span class="token plain"> -R </span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token plain"> /home/architecture/nexus-data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker run -id --privileged</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true --restart</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">always -p </span><span class="token number" style="color:rgb(247, 140, 108)">8081</span><span class="token plain">:8081 --name nexus3 -v /home/architecture/nexus-data:/nexus-data sonatype/nexus3</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>启动服务需要等待一段时间，可以通过以下命令查询进度。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker logs -f nexus3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 看到类似如下字样表示成功</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">started sonatype nexus oss</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="验证数据化持久生效"></a>验证数据化持久生效<a class="hash-link" href="#验证数据化持久生效" title="Direct link to heading">#</a></h3><p>进入我们刚才在虚拟机实例中创建的 <code>/home/architecture/nexus-data</code> 目录。</p><p>如果 <code>/home/architecture/nexus-data</code> 目录下有许多目录和文件，说明我们已经成功地把容器中的 <code>/nexus-data</code> 映射到虚拟机实例中的 <code>/home/architecture/nexus-data</code>。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /home/architecture/nexus-data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">  blobs  cache  db  elasticsearch  etc  generated-bundles  instances  javaprefs  karaf.pid  keystores  lock  log  orient  port  restore-from-backup  tmp</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置安全组"></a><strong>配置安全组</strong><a class="hash-link" href="#配置安全组" title="Direct link to heading">#</a></h3><p>为 TCP 8081 添加访问规则</p><ul><li>优先级：2</li><li>方向：下行规则</li><li>行为：接受</li><li>协议：TCP</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="登录-nexus"></a><strong>登录 Nexus</strong><a class="hash-link" href="#登录-nexus" title="Direct link to heading">#</a></h3><p>打开 <code>http://&lt;registry ip&gt;:8081</code> 后，需要登录。</p><ol><li>用户名是 admin</li><li>密码是初始密码。需要进入容器，拿到 /nexus-data/admin.password 下的文本。</li></ol><p>我们先查询 container_id：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker </span><span class="token function" style="color:rgb(130, 170, 255)">ps</span><span class="token plain"> -a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONTAINER ID   IMAGE                 COMMAND                  CREATED          STATUS                     PORTS                                                  NAMES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">b0214fa54fb9   sonatype/nexus3       </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sh -c ${SONATYPE_DI…&quot;</span><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">17</span><span class="token plain"> minutes ago   Up </span><span class="token number" style="color:rgb(247, 140, 108)">17</span><span class="token plain"> minutes              </span><span class="token number" style="color:rgb(247, 140, 108)">0.0</span><span class="token plain">.0.0:8081-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token number" style="color:rgb(247, 140, 108)">8081</span><span class="token plain">/tcp, :::8081-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token number" style="color:rgb(247, 140, 108)">8081</span><span class="token plain">/tcp              nexus3</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>再进入容器拿到 /nexus-data/admin.password 文本文件中存放的初始密码。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">container_id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> /nexus-data/admin.password</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>得到一个初始密码字符串：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ 3d331fa3-f54b-45f8-8ecf-482ccec85593</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="登录后的配置"></a><strong>登录后的配置</strong><a class="hash-link" href="#登录后的配置" title="Direct link to heading">#</a></h3><p>使用 <code>admin</code> 和 <code>3d331fa3-f54b-45f8-8ecf-482ccec85593</code> 登录后，继续往下进行几个步骤：</p><ol><li>choose a password for the admin user(为 admin user 创建一个密码)<ul><li>这是管理员密码，改为一个复杂密码。</li></ul></li><li>Configure Anonymous Access(配置匿名访问)。<ul><li>Enable anonymous access(启用匿名访问)。意味着默认情况下，用户无需凭据即可从存储库中搜索、浏览和下载组件。请考虑对你的组织的安全影响。</li><li>Disable anonymous access(禁用匿名访问)。应该谨慎选择，因为它需要所有用户和构建工具的凭据。</li><li>我们选择 <code>Disable anonymous access</code>。</li></ul></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置-npm-仓库"></a>配置 npm 仓库<a class="hash-link" href="#配置-npm-仓库" title="Direct link to heading">#</a></h2><p>导航打开 Administration 管理页面。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="预先准备：为-npm-仓库创建一个-blob-store-type"></a>预先准备：为 npm 仓库创建一个 <a href="https://help.sonatype.com/repomanager3/repository-management#RepositoryManagement-ChoosingtheBlobStoreType" target="_blank" rel="noopener noreferrer">Blob Store Type</a><a class="hash-link" href="#预先准备：为-npm-仓库创建一个-blob-store-type" title="Direct link to heading">#</a></h3><p>进入 Repository =&gt; Blob Stores，点击 Create blob store。</p><p>Type 选择 File，Name 输入 npm，Path 自动输入 /nexus-data/blobs/npm</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="预先准备：为-npm-仓库创建一个-清理策略"></a>预先准备：为 npm 仓库创建一个 <a href="https://help.sonatype.com/repomanager3/repository-management/cleanup-policies" target="_blank" rel="noopener noreferrer">清理策略</a><a class="hash-link" href="#预先准备：为-npm-仓库创建一个-清理策略" title="Direct link to heading">#</a></h3><p>进入 Repository =&gt; Cleanup Policies =&gt; 点击 Create Cleanup Policy。</p><ol><li>Name 输入 npm</li><li>Format 选择 npm</li><li>Cleanup Criteria(清理标准)。<ul><li>勾选 Component Usage，输入 1 days。这里的意思应该是，删除 1 天内未下载的组件。暂时这么理解。</li></ul></li></ol><p>点击 Save 保存。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="测试可以清理的组件"></a>测试可以清理的组件<a class="hash-link" href="#测试可以清理的组件" title="Direct link to heading">#</a></h3><p>在每个清理策略的下面，有一个 Preview Repository。可以选中一个 Repository 来查看可以清理的组件。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置-npm-仓库-1"></a>配置 npm 仓库<a class="hash-link" href="#配置-npm-仓库-1" title="Direct link to heading">#</a></h3><p>进入 Repository =&gt; Repositories，点击 Create Repositories。</p><p>这里介绍下三种 npm 仓库的用途</p><ul><li>npm(proxy) 用于获取非研发内部的 package，所有在 npm(hosted) 的找不到的 package，都会被代理到外部的公共 package。通常我们会代理到 npm 淘宝源</li><li>npm(hosted) 用于托管研发内部使用的私有 package。当我们发布 package时，需要将发布源设置为此仓库的链接。</li><li>npm(group) 用于将以上两种组合在一起，这个仓库算是真正的获取 package 的入口。从外部看起来，我们只从此仓库的链接拉取，仓库内部会自动判断是从 npm(hosted) 或 npm(proxy) 拉取。</li></ul><p>根据以上信息，我们先创建 npm(proxy)</p><ol><li>Name 输入 npm-proxy。</li><li>Remote storage 输入 <a href="https://registry.npm.taobao.org" target="_blank" rel="noopener noreferrer">https://registry.npm.taobao.org</a>。也可以设置别的源，例如 <a href="https://registry.npmjs.org/" target="_blank" rel="noopener noreferrer">https://registry.npmjs.org/</a>。</li><li>Maximum component age 和 Maximum metadata age。这里 <a href="https://support.sonatype.com/hc/en-us/articles/115010182627-Understanding-Caching-Configuration" target="_blank" rel="noopener noreferrer">https://support.sonatype.com/hc/en-us/articles/115010182627-Understanding-Caching-Configuration</a> 有解释，不过没看明白。都配置为配置 0，随时拉取最新。</li><li>Blob store 选择刚才我们创建好的，名称为 npm 的 Blob store。</li><li>Cleanup Policies 选择刚才我们创建好的，名称为 npm 的清理策略。</li></ol><p>接着创建 npm(hosted)</p><ol><li>Name 输入 npm-hosted。</li><li>Blob store 选择刚才我们创建好的，名称为 npm 的 Blob store。</li><li>Deployment policy 选择 <strong>Allow redeploy</strong>。这样我们可以 npm unpublish 取消发布后再重新发布。</li></ol><p>最后我们创建 npm(group)</p><ol><li>Name 输入 npm-group。</li><li>Blob store 选择刚才我们创建好的，名称为 npm 的 Blob store。</li><li>Member repositories 将左侧的选项全部添加到右侧的 Members</li></ol><p>这样我们就实现 npm registry 的配置。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置授权访问"></a>配置授权访问<a class="hash-link" href="#配置授权访问" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置角色和用户"></a>配置角色和用户<a class="hash-link" href="#配置角色和用户" title="Direct link to heading">#</a></h3><p>打开 Security =&gt; Roles 和  Security =&gt; Users</p><p>创建一个发布角色</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Role ID: deployer</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Role name: deployer</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Privileges: </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  nx-repository-view-npm-npm-group-* // 关联 npm-group 仓库权限</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  nx-repository-view-npm-npm-hosted-* // 关联 npm-hosted 仓库权限</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  nx-repository-view-npm-npm-proxy-* // 关联 npm-proxy 仓库权限</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Roles: nx-admin</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>创建一个发布用户</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ID: lizhihua</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First name: lizhihua</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Last name: lizhihua</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Email: example@qq.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Password: xxx</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Confirm Password: xxx</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Status: Active</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Roles:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  npm-depolyer // 关联刚才创建的发布角色</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  nx-admin</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="开启-npm-bearer-token-realm"></a>开启 npm Bearer Token Realm<a class="hash-link" href="#开启-npm-bearer-token-realm" title="Direct link to heading">#</a></h3><p>打开 Security =&gt; Realms</p><p>在 active 列表里面添加 <code>npm Bearer Token Realm</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="登录-npm-group，用于拉取-npm-hosted-的-private-package-和-npm-proxy-的-public-package"></a>登录 npm-group，用于拉取 npm-hosted 的 private package 和 npm-proxy 的 public package<a class="hash-link" href="#登录-npm-group，用于拉取-npm-hosted-的-private-package-和-npm-proxy-的-public-package" title="Direct link to heading">#</a></h2><p>全局配置 registry</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 打开 ~/.npmrc 后添加如下内容</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">registry</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http://</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">registry ip</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:8081/repository/npm-group/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>随便安装一个 package，没登录过会报错 code E401。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> fs-extra</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> ERR</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"> code E401</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> ERR</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"> Unable to authenticate, need: BASIC </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">realm</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Sonatype Nexus Repository Manager&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>登录到 npm-group</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> login // 输入上面配置过的 username, password, email</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Logged </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> as lizhihua on http://</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">registry ip</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:8081/repository/npm-group/.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>.npmrc 文件中会增加一行 _authToken，此 token 负责在拉取 npm package 时验证</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">//&lt;registry ip&gt;:8081/repository/npm-group/:_authToken=NpmToken.a1s2d3f4-7c7c-33cc-b999-7n05be25e0d0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>再次安装 package</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> fs-extra</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+ fs-extra@10.0.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">added </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"> packages </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> 3s</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="登录-npm-hosted，用于发布-private-package"></a>登录 npm-hosted，用于发布 private package<a class="hash-link" href="#登录-npm-hosted，用于发布-private-package" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> adduser --registry</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http://</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">registry ip</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:8081/repository/npm-hosted/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Logged </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> as lizhihua on http://</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">registry ip</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:8081/repository/npm-hosted/.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>.npmrc 文件中会增加一行 _authToken，此 token 负责在发布 npm package 时验证</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">//hub.spoton.cn/repository/npm-group/:_authToken=NpmToken.a1s2d3f4-7c7c-33cc-b999-7n05be25e0d0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>使用以下 package.json 测试发布</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;name&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@scope/package&quot;</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;version&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.0.0&quot;</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;publishConfig&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registry&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://&lt;registry ip&gt;:8081/repository/npm-hosted/&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;dependencies&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;fs-extra&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;^9.1.0&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="两种发布方式"></a>两种发布方式<a class="hash-link" href="#两种发布方式" title="Direct link to heading">#</a></h3><p>方式一：在 package.json 中添加 publishConfig 指定发布源，通过 npm publish 发布</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;publishConfig&quot; : {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;registry&quot; : &quot;http://&lt;registry ip&gt;:8081/repository/npm-hosted/&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>方式二：直接通过 <code>npm publish --registry=http://&lt;registry ip&gt;:8081/repository/npm-hosted/</code> 发布</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="问题汇总"></a>问题汇总<a class="hash-link" href="#问题汇总" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="npm-login-无法登录"></a>npm login 无法登录<a class="hash-link" href="#npm-login-无法登录" title="Direct link to heading">#</a></h3><p>注意 .npmrc 中 registry 路径不要写错，后面的 <code>/repository/npm-group/</code> 不能少。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://&lt;registry ip&gt;:8081/repository/npm-group/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="yarn-无法使用-npm-bearer-token-realm"></a>yarn 无法使用 npm Bearer Token Realm<a class="hash-link" href="#yarn-无法使用-npm-bearer-token-realm" title="Direct link to heading">#</a></h3><ul><li><a href="https://stackoverflow.com/questions/61407791/yarn-not-working-with-nexus-3-npm-proxy-repository" target="_blank" rel="noopener noreferrer">yarn not working with nexus 3 npm proxy repository</a></li></ul><p>解决办法是在 .npmrc 中 registry 下面添加 <code>always-auth=true</code>。例如：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">registry=http://&lt;registry ip&gt;:8081/repository/npm-group/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">always-auth=true # 在这里添加</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//&lt;registry ip&gt;:8081/repository/npm-group/:_authToken=NpmToken.a1s2d3f4-7c7c-33cc-b999-7n05be25e0d0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//&lt;registry ip&gt;:8081/repository/npm-hosted/:_authToken=NpmToken.a1s2d3f4-7c7c-33cc-b999-7n05be25e0d0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="nginx-代理服务，页面中静态资源的引用路径错误"></a>nginx 代理服务，页面中静态资源的引用路径错误<a class="hash-link" href="#nginx-代理服务，页面中静态资源的引用路径错误" title="Direct link to heading">#</a></h3><ul><li><a href="https://help.sonatype.com/repomanager3/installation/run-behind-a-reverse-proxy" target="_blank" rel="noopener noreferrer">Running Behind a Reverse Proxy - nginx</a></li></ul><p>问题描述：</p><p>我们通常会通过域名 <code>hub.***.com</code> 来代理 <code>&lt;registry ip&gt;:8081</code> 这个服务。</p><p>在使用 nginx 代理后，返回的 HTML 页面中，所有静态资源的引用路径都是 <code>http://localhost:8081/static/***</code>。</p><p>解决思路：</p><p>在配置代理时，需要把 request headers 的 Host 带上。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">server {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    listen  80;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server_name hub.***.com; # </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    location / {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_pass http://localhost:8081/;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Host $host; # 注意配置此 header</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/linux/docker_install_sonatype_nexus_repository_manager.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/docs/linux/docker_install_redis"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 通过 Docker 安装 Redis</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/docs/linux/docker_install_yapi"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">通过 Docker 安装 yapi »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#重要声明" class="table-of-contents__link">重要声明</a></li><li><a href="#运行容器" class="table-of-contents__link">运行容器</a><ul><li><a href="#拉取镜像" class="table-of-contents__link"><strong>拉取镜像</strong></a></li><li><a href="#如何配置持久化数据？" class="table-of-contents__link">如何配置持久化数据？</a></li><li><a href="#如何配置后台式容器？" class="table-of-contents__link">如何配置后台式容器？</a></li><li><a href="#运行-nexus-容器" class="table-of-contents__link"><strong>运行 Nexus 容器</strong></a></li><li><a href="#验证数据化持久生效" class="table-of-contents__link">验证数据化持久生效</a></li><li><a href="#配置安全组" class="table-of-contents__link"><strong>配置安全组</strong></a></li><li><a href="#登录-nexus" class="table-of-contents__link"><strong>登录 Nexus</strong></a></li><li><a href="#登录后的配置" class="table-of-contents__link"><strong>登录后的配置</strong></a></li></ul></li><li><a href="#配置-npm-仓库" class="table-of-contents__link">配置 npm 仓库</a><ul><li><a href="#预先准备：为-npm-仓库创建一个-blob-store-type" class="table-of-contents__link">预先准备：为 npm 仓库创建一个 Blob Store Type</a></li><li><a href="#预先准备：为-npm-仓库创建一个-清理策略" class="table-of-contents__link">预先准备：为 npm 仓库创建一个 清理策略</a></li><li><a href="#测试可以清理的组件" class="table-of-contents__link">测试可以清理的组件</a></li><li><a href="#配置-npm-仓库-1" class="table-of-contents__link">配置 npm 仓库</a></li></ul></li><li><a href="#配置授权访问" class="table-of-contents__link">配置授权访问</a><ul><li><a href="#配置角色和用户" class="table-of-contents__link">配置角色和用户</a></li><li><a href="#开启-npm-bearer-token-realm" class="table-of-contents__link">开启 npm Bearer Token Realm</a></li></ul></li><li><a href="#登录-npm-group，用于拉取-npm-hosted-的-private-package-和-npm-proxy-的-public-package" class="table-of-contents__link">登录 npm-group，用于拉取 npm-hosted 的 private package 和 npm-proxy 的 public package</a></li><li><a href="#登录-npm-hosted，用于发布-private-package" class="table-of-contents__link">登录 npm-hosted，用于发布 private package</a><ul><li><a href="#两种发布方式" class="table-of-contents__link">两种发布方式</a></li></ul></li><li><a href="#问题汇总" class="table-of-contents__link">问题汇总</a><ul><li><a href="#npm-login-无法登录" class="table-of-contents__link">npm login 无法登录</a></li><li><a href="#yarn-无法使用-npm-bearer-token-realm" class="table-of-contents__link">yarn 无法使用 npm Bearer Token Realm</a></li><li><a href="#nginx-代理服务，页面中静态资源的引用路径错误" class="table-of-contents__link">nginx 代理服务，页面中静态资源的引用路径错误</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/docs/">开始</a></li></ul></div><div class="col footer__col"><div class="footer__title">联系反馈</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/dear-lizhihua/blog/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>友好讨论<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/dear-lizhihua" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 李志华</div></div></div></footer></div>
<script src="/blog/assets/js/runtime~main.59631cfa.js"></script>
<script src="/blog/assets/js/main.cdfbdb9d.js"></script>
</body>
</html>