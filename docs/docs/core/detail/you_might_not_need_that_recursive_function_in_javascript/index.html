<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/blog/blog/rss.xml" title="æå¿—åçš„åšå®¢ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/blog/atom.xml" title="æå¿—åçš„åšå®¢ Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-478GETJ8M8","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<script async src="https://hm.baidu.com/hm.js?6cf455aa46dc50a069ab28ba6ecbf4ce"></script><title data-react-helmet="true">ä½ å¯èƒ½ä¸éœ€è¦åœ¨ JavaScript ä¸­é€’å½’å‡½æ•° | æå¿—åçš„åšå®¢</title><meta data-react-helmet="true" property="og:url" content="https://dear-lizhihua.github.io/blog/docs//blog/docs/core/detail/you_might_not_need_that_recursive_function_in_javascript"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ä½ å¯èƒ½ä¸éœ€è¦åœ¨ JavaScript ä¸­é€’å½’å‡½æ•° | æå¿—åçš„åšå®¢"><meta data-react-helmet="true" name="description" content="åŸæ–‡ï¼šYou Might Not Need that Recursive Function in JavaScript"><meta data-react-helmet="true" property="og:description" content="åŸæ–‡ï¼šYou Might Not Need that Recursive Function in JavaScript"><link data-react-helmet="true" rel="shortcut icon" href="/blog/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://dear-lizhihua.github.io/blog/docs//blog/docs/core/detail/you_might_not_need_that_recursive_function_in_javascript"><link data-react-helmet="true" rel="alternate" href="https://dear-lizhihua.github.io/blog/docs//blog/docs/core/detail/you_might_not_need_that_recursive_function_in_javascript" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dear-lizhihua.github.io/blog/docs//blog/docs/core/detail/you_might_not_need_that_recursive_function_in_javascript" hreflang="x-default"><link rel="stylesheet" href="/blog/assets/css/styles.1a90c8a2.css">
<link rel="preload" href="/blog/assets/js/runtime~main.59631cfa.js" as="script">
<link rel="preload" href="/blog/assets/js/main.cdfbdb9d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog/"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">æå¿—åçš„åšå®¢</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/docs">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/blog/blog">åšå®¢</a></div><div class="navbar__items navbar__items--right"><a href="http://netsysd.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>å¤§ä¼—å…‰æ˜å¯¼èˆª<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/blog/blog/change-log">æ›´æ–°æ—¥å¿—</a><a class="navbar__item navbar__link" href="/blog/docs/translations/babel">Babel æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/blog/docs/translations/rollup">Rollup æ–‡æ¡£</a><a href="https://github.com/dear-lizhihua" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/blog/"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/blog/img/logo.svg" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">æå¿—åçš„åšå®¢</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog/docs">æ–‡æ¡£</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/blog">åšå®¢</a></li><li class="menu__list-item"><a href="http://netsysd.com/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>å¤§ä¼—å…‰æ˜å¯¼èˆª<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a class="menu__link" href="/blog/blog/change-log">æ›´æ–°æ—¥å¿—</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/docs/translations/babel">Babel æ–‡æ¡£</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/docs/translations/rollup">Rollup æ–‡æ¡£</a></li><li class="menu__list-item"><a href="https://github.com/dear-lizhihua" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">ä½ å¯èƒ½ä¸éœ€è¦åœ¨ JavaScript ä¸­é€’å½’å‡½æ•°</h1></header><blockquote><p>åŸæ–‡ï¼š<a href="https://hackernoon.com/you-might-not-need-that-recursive-function-in-javascript-275651522185" target="_blank" rel="noopener noreferrer">You Might Not Need that Recursive Function in JavaScript</a></p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é‡è¦å£°æ˜"></a>é‡è¦å£°æ˜<a class="hash-link" href="#é‡è¦å£°æ˜" title="Direct link to heading">#</a></h2><p>è¿™ç¯‡ä¸»è¦æ˜¯è®°å½•ä¸‹ <code>å¦‚ä½•é€šè¿‡ä¸€æ¬¡éå†æ„å»ºä¸€ä¸ªæ ‘</code>ï¼Œç»“è®ºç›´æ¥çœ‹æ–‡ç« æœ€åçš„ä»£ç ã€‚</p><p>æ–‡ç« å°±ä¸å…¨éƒ¨ç¿»è¯‘äº†ï¼Œåªç¿»è¯‘é‡è¦å†…å®¹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ–‡ç« å†…å®¹"></a>æ–‡ç« å†…å®¹<a class="hash-link" href="#æ–‡ç« å†…å®¹" title="Direct link to heading">#</a></h2><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é¢ä¸´è¿™æ ·çš„æƒ…å†µï¼šç­”æ¡ˆä¼¼ä¹éœ€è¦ä»¥ä¸ç¡®å®šçš„æ¬¡æ•°è§£å†³åŒä¸€ä¸ªé—®é¢˜ã€‚å½“æˆ‘ä»¬é‡åˆ°è¿™æ ·çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å€¾å‘äºä½¿ç”¨é€’å½’ â€”â€” é€šå¸¸é€šè¿‡åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥å®ç°ï¼Œè¯¥å‡½æ•°æ ¹æ®éœ€è¦å¤šæ¬¡è°ƒç”¨è‡ªèº«ã€‚é€’å½’åœ¨ç¼–ç¨‹ä¸­æå…¶é‡è¦ï¼Œå¾ˆå¤šé—®é¢˜åªèƒ½é€šè¿‡ä½¿ç”¨å®ƒæ¥è§£å†³ã€‚è¯è™½å¦‚æ­¤ï¼Œé€’å½’å¯èƒ½ä¼šæ›´æ…¢ï¼Œå¡«æ»¡è°ƒç”¨å †æ ˆï¼Œå¹¶ä¸”åœ¨æ¦‚å¿µä¸Šå¯èƒ½æ›´æ£˜æ‰‹ã€‚</p><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æ¢è®¨ä¸€ä¸ªé—®é¢˜çš„ç¤ºä¾‹ï¼Œè¯¥é—®é¢˜ä¼¼ä¹é€‚åˆé€’å½’è§£å†³æ–¹æ¡ˆï¼Œä½†å®é™…ä¸Šå¯ä»¥é€šè¿‡å¯¹ JavaScript å¯¹è±¡å¼•ç”¨çš„ç†è§£æ¥æ›´æœ‰æ•ˆåœ°è§£å†³ã€‚è¿™ä¸ªå¸–å­ç¤ºä¾‹çš„åŠ¨æœºæ¥è‡ªæˆ‘æ”¹ç¼–çš„ä¸€ä¸ªä¼˜ç§€çš„ <a href="https://stackoverflow.com/a/18018037/6525724" target="_blank" rel="noopener noreferrer">StackOverflow ç­”æ¡ˆ</a>ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æå‡ºé—®é¢˜"></a>æå‡ºé—®é¢˜<a class="hash-link" href="#æå‡ºé—®é¢˜" title="Direct link to heading">#</a></h3><p>åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾åŸºäºä¸€ä¸ªæ‰å¹³çš„å¯¹è±¡æ•°ç»„ï¼Œæ¥æ„å»ºä¸€ä¸ªå±‚çº§çš„å¯¹è±¡æ ‘ç»“æ„ã€‚äº‹å…ˆä¸çŸ¥é“æ ‘çš„æ·±åº¦ï¼Œä½†æ˜¯çŸ¥é“æ¯ä¸ªèŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å­èŠ‚ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥å¯è§†åŒ–åœ°å±•ç¤ºä¸€ä¸ªç¤ºä¾‹æ ‘ï¼š</p><p><img alt="Example Tree Structure" src="/blog/assets/images/example_tree_structure-5b45ae46077916a2e5b096aadab36848.png"></p><p><em>(ç¤ºä¾‹æ ‘ç»“æ„)</em></p><p>As mentioned, the data we receive to build this tree example is a flattened array in the following format. Each element represents one node of the tree and can be the child of only one parent node. Node 8 has no parent, so we can see in the array below that the object for <code>id</code> 8 has a <code>parentId</code> equal to <code>null</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">const flat = [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 1, parentId: 3 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 3, parentId: 8 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 4, parentId: 6 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 6, parentId: 3 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 7, parentId: 6 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 8, parentId: null },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 10, parentId: 8 }, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 13, parentId: 14 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 14, parentId: 10 }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The final structure we need to rearrange this flat array into is as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 8,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    children: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        id: 3, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        children: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            id: 1, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            children: [] </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            id: 6, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            children: [ </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              { id: 4, children: [] }, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              { id: 7, children: [] } </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ] </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        id: 10, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        children: [ </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            id: 14, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            children: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              { id: 13, children: [] }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ] </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ<a class="hash-link" href="#è§£å†³æ–¹æ¡ˆ" title="Direct link to heading">#</a></h3><p>Your first inkling in this scenario might be to reach for recursion: weâ€™re given a tree of indeterminate length. We imagine we might have to create a function that populates a nodeâ€™s children. Then, we recursively call that function until the tree is fully populated and (i.e., no more child nodes are found).</p><p>While this would probably work, there is a better way!</p><p>æˆ‘ä»¬å¯ä»¥ç®€å•åœ°éå†æ•°ç»„ï¼Œå¹¶å°†æ¯ä¸ªå¯¹è±¡åˆ†é…ç»™å…¶çˆ¶å¯¹è±¡çš„ <code>children</code> æ•°ç»„ã€‚This may not make intuitive sense, but consider this logic:</p><p>å¯¹è±¡ <code>3</code> è¢«åˆ†é…ç»™å¯¹è±¡ <code>8</code> çš„ <code>children</code> æ•°ç»„
å¯¹è±¡ <code>6</code> è¢«åˆ†é…ç»™å¯¹è±¡ <code>3</code> çš„ <code>children</code> æ•°ç»„</p><p>åˆ†é…ç»™å¯¹è±¡ <code>8</code> çš„ <code>children</code> æ•°ç»„çš„å¯¹è±¡ <code>3</code>ï¼Œå®é™…ä¸Šåªæ˜¯å¯¹å†…å­˜ä¸­å¯¹è±¡ <code>3</code> çš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€å®ƒçš„ <code>children</code> æ•°ç»„å°†å…·æœ‰å¯¹è±¡ <code>6</code> å¼•ç”¨ã€‚</p><p>This logic extends to the entire array, meaning we just need to go through the array once to build out our tree!</p><p>Here is a potential non-recursive solution based on this idea:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">const flat = [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 1, parentId: 3 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 3, parentId: 8 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 4, parentId: 6 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 6, parentId: 3 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 7, parentId: 6 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 8, parentId: null },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 10, parentId: 8 }, </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 13, parentId: 14 },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { id: 14, parentId: 10 }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create root for top-level node(s)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const root = [];</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">flat.forEach(node =&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // No parentId means top level</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if (!node.parentId) return root.push(node);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // Insert node as child of parent in flat array</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  const parentIndex = flat.findIndex(el =&gt; el.id === node.parentId);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if (!flat[parentIndex].children) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return flat[parentIndex].children = [node];</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  flat[parentIndex].children.push(node);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(root);</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Nice and simple, and we only iterate through the array once!</p><p>è¿™é‡Œæˆ‘æƒ³åšä¸€ä¸ªé¢å¤–çš„ä¼˜åŒ–ï¼šæ¯æ¬¡å¾ªç¯ä½¿ç”¨çš„ findIndex å‡½æ•°å¯¹äºå°çš„ç¤ºä¾‹æ ‘æ¥è¯´å¹¶ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸€æ£µå¤§çš„æ ‘ï¼Œè¿™å®é™…ä¸Šå¯èƒ½ä¼šå˜å¾—æ€§èƒ½å·®ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ¥ç¼“å­˜æ‰¾åˆ°çš„çˆ¶ä½ç½®ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create root for top-level node(s)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const root = [];</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Cache found parent index</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const map = {};</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">flat.forEach(node =&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // No parentId means top level</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if (!node.parentId) return root.push(node);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // Insert node as child of parent in flat array</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  let parentIndex = map[node.parentId];</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if (typeof parentIndex !== &quot;number&quot;) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    parentIndex = flat.findIndex(el =&gt; el.id === node.parentId);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    map[node.parentId] = parentIndex;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if (!flat[parentIndex].children) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return flat[parentIndex].children = [node];</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  flat[parentIndex].children.push(node);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(root);</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Success! We have accomplished our tree build without implementing a recursive function.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/core/detail/you_might_not_need_that_recursive_function_in_javascript.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#é‡è¦å£°æ˜" class="table-of-contents__link">é‡è¦å£°æ˜</a></li><li><a href="#æ–‡ç« å†…å®¹" class="table-of-contents__link">æ–‡ç« å†…å®¹</a><ul><li><a href="#æå‡ºé—®é¢˜" class="table-of-contents__link">æå‡ºé—®é¢˜</a></li><li><a href="#è§£å†³æ–¹æ¡ˆ" class="table-of-contents__link">è§£å†³æ–¹æ¡ˆ</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">æ–‡æ¡£</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/docs/">å¼€å§‹</a></li></ul></div><div class="col footer__col"><div class="footer__title">è”ç³»åé¦ˆ</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/dear-lizhihua/blog/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>å‹å¥½è®¨è®º<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/dear-lizhihua" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 æå¿—å</div></div></div></footer></div>
<script src="/blog/assets/js/runtime~main.59631cfa.js"></script>
<script src="/blog/assets/js/main.cdfbdb9d.js"></script>
</body>
</html>