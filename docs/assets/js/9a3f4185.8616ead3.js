(self.webpackChunk_site_blog=self.webpackChunk_site_blog||[]).push([[8433],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return u},kt:function(){return k}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=s(t),k=r,m=d["".concat(p,".").concat(k)]||d[k]||c[k]||o;return t?a.createElement(m,l(l({ref:n},u),{},{components:t})):a.createElement(m,l({ref:n},u))}));function k(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,l=new Array(o);l[0]=d;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var s=2;s<o;s++)l[s]=t[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},4031:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return u},default:function(){return d}});var a=t(2122),r=t(9756),o=(t(7294),t(3905)),l=["components"],i={id:"how_to_build_a_hello_world_application_with_koa",title:"\u4f7f\u7528 Koa \u6784\u5efa\u4e00\u4e2a hello world \u5e94\u7528\u7a0b\u5e8f"},p=void 0,s={unversionedId:"core/server/how_to_build_a_hello_world_application_with_koa",id:"core/server/how_to_build_a_hello_world_application_with_koa",isDocsHomePage:!1,title:"\u4f7f\u7528 Koa \u6784\u5efa\u4e00\u4e2a hello world \u5e94\u7528\u7a0b\u5e8f",description:"\u4ecb\u7ecd",source:"@site/docs/core/server/how_to_build_a_hello_world_application_with_koa.md",sourceDirName:"core/server",slug:"/core/server/how_to_build_a_hello_world_application_with_koa",permalink:"/blog/docs/core/server/how_to_build_a_hello_world_application_with_koa",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/core/server/how_to_build_a_hello_world_application_with_koa.md",version:"current",frontMatter:{id:"how_to_build_a_hello_world_application_with_koa",title:"\u4f7f\u7528 Koa \u6784\u5efa\u4e00\u4e2a hello world \u5e94\u7528\u7a0b\u5e8f"},sidebar:"docs",previous:{title:"Node.js \u57fa\u7840",permalink:"/blog/docs/extension/node_js/index"},next:{title:"\u5982\u4f55\u4f7f\u7528 Inquirer.js \u521b\u5efa\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u63d0\u793a",permalink:"/blog/docs/core/server/how_to_create_interactive_command_line_prompts_with_inquirer_js"}},u=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",children:[]},{value:"\u51c6\u5907\u5de5\u4f5c",id:"\u51c6\u5907\u5de5\u4f5c",children:[]},{value:"\u6b65\u9aa4 1 \u2014 \u8bbe\u7f6e\u4f60\u7684\u9879\u76ee",id:"\u6b65\u9aa4-1--\u8bbe\u7f6e\u4f60\u7684\u9879\u76ee",children:[]},{value:"\u6b65\u9aa4 2 \u2014 \u521b\u5efa\u4e00\u4e2a Koa Server",id:"\u6b65\u9aa4-2--\u521b\u5efa\u4e00\u4e2a-koa-server",children:[]},{value:"\u6b65\u9aa4 3 \u2014 \u6dfb\u52a0\u8def\u7531\u548c\u89c6\u56fe\u6e32\u67d3",id:"\u6b65\u9aa4-3--\u6dfb\u52a0\u8def\u7531\u548c\u89c6\u56fe\u6e32\u67d3",children:[]},{value:"\u6b65\u9aa4 4 \u2014 \u5904\u7406\u9519\u8bef\u548c\u54cd\u5e94",id:"\u6b65\u9aa4-4--\u5904\u7406\u9519\u8bef\u548c\u54cd\u5e94",children:[]},{value:"Conclusion",id:"conclusion",children:[]}],c={toc:u};function d(e){var n=e.components,t=(0,r.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"\u4ecb\u7ecd"},"\u4ecb\u7ecd"),(0,o.kt)("p",null,"Koa \u662f ",(0,o.kt)("a",{parentName:"p",href:"https://expressjs.com/"},"Express")," \u80cc\u540e\u7684\u56e2\u961f\u521b\u5efa\u7684\u4e00\u4e2a\u65b0\u7684 web \u6846\u67b6\u3002\u5b83\u7684\u76ee\u7684\u5728\u4e8e\u6210\u4e3a\u4e00\u4e2a Express \u7684\u73b0\u4ee3\u548c\u66f4\u7b80\u7ea6\u7684\u7248\u672c\u3002"),(0,o.kt)("p",null,"\u5b83\u7684\u4e00\u4e9b\u7279\u70b9\u662f\u652f\u6301\u548c\u4f9d\u8d56\u6700\u65b0\u7684 JavaScript \u529f\u80fd\uff08\u4f8b\u5982 ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator"},"generators")," \u548c  ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"},"async/await"),"\u3002Koa \u6ca1\u6709\u9644\u5e26\u4efb\u4f55\u4e2d\u95f4\u4ef6\uff0c\u5c3d\u7ba1\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u63d2\u4ef6\u548c\u73b0\u6709\u63d2\u4ef6\u5bf9\u5176\u8fdb\u884c\u6269\u5c55\u3002"),(0,o.kt)("p",null,"\u5728\u672c\u6587\u4e2d\uff0c\u4f60\u5c06\u4e86\u89e3\u6709\u5173 Koa \u6846\u67b6\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u5e76\u6784\u5efa\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4ee5\u719f\u6089\u5176\u529f\u80fd\u548c\u7406\u5ff5\u3002"),(0,o.kt)("h2",{id:"\u51c6\u5907\u5de5\u4f5c"},"\u51c6\u5907\u5de5\u4f5c"),(0,o.kt)("p",null,"\u5982\u679c\u4f60\u60f3\u8ddf\u7740\u8fd9\u7bc7\u6587\u7ae0\u5b66\u4e60\uff0c\u4f60\u9700\u8981\u5b8c\u6210\u5982\u4e0b\u51c6\u5907\u5de5\u4f5c\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u6309\u7167 ",(0,o.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorial_series/how-to-install-node-js-and-create-a-local-development-environment"},"\u5982\u4f55\u5b89\u88c5 Node.js \u5e76\u521b\u5efa\u4e00\u4e2a\u672c\u5730\u5f00\u53d1\u73af\u5883")," \u8fd9\u7bc7\u6587\u7ae0\uff0c\u5728\u672c\u5730\u5b89\u88c5 Node.js\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u8fd8\u9700\u8981\u6709 JavaScript \u548c ES6 \u8bed\u6cd5\u7684\u57fa\u672c\u77e5\u8bc6\u3002")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u672c\u6559\u7a0b\u5df2\u4ece Koa 1.0 \u4fee\u8ba2\u4e3a Koa 2.0\u3002\u8bf7\u53c2\u8003 ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/koajs/koa/blob/master/docs/migration.md"},"\u8fc1\u79fb\u6587\u6863")," \u6765\u66f4\u65b0\u4f60\u7684 1.0 \u5b9e\u73b0\u3002"),(0,o.kt)("p",null,"\u672c\u6559\u7a0b\u5df2\u7ecf\u5728 ",(0,o.kt)("inlineCode",{parentName:"p"},"Node")," v15.14.0, ",(0,o.kt)("inlineCode",{parentName:"p"},"npm")," v7.10.0, ",(0,o.kt)("inlineCode",{parentName:"p"},"koa")," v2.13.1, ",(0,o.kt)("inlineCode",{parentName:"p"},"@koa/router")," v10.0.0 \u548c ",(0,o.kt)("inlineCode",{parentName:"p"},"koa-ejs")," v4.3.0 \u4e0a\u9a8c\u8bc1\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa4-1--\u8bbe\u7f6e\u4f60\u7684\u9879\u76ee"},"\u6b65\u9aa4 1 \u2014 \u8bbe\u7f6e\u4f60\u7684\u9879\u76ee"),(0,o.kt)("p",null,"\u9996\u5148\uff0c\u4e3a\u9879\u76ee\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u76ee\u5f55\u3002\u53ef\u4ee5\u901a\u8fc7\u5728\u7ec8\u7aef\u4e2d\u590d\u5236\u5e76\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b8c\u6210\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir koa-example\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u53ef\u4ee5\u7ed9\u9879\u76ee\u8d77\u4efb\u610f\u7684\u540d\u79f0\uff0c\u4f46\u672c\u6587\u5c06\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"koa-example")," \u4f5c\u4e3a\u9879\u76ee\u548c\u76ee\u5f55\u7684\u540d\u79f0\u3002"),(0,o.kt)("p",null,"\u6b64\u65f6\uff0c\u4f60\u5df2\u7ecf\u521b\u5efa\u4e86\u9879\u76ee\u76ee\u5f55 ",(0,o.kt)("inlineCode",{parentName:"p"},"koa-example"),"\u3002\u5bfc\u822a\u5230\u65b0\u521b\u5efa\u7684\u9879\u76ee\u76ee\u5f55\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd koa-example\n")),(0,o.kt)("p",null,"\u7136\u540e\uff0c\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u521d\u59cb\u5316\u4f60\u7684 Node.js \u9879\u76ee\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm init -y\n")),(0,o.kt)("p",null,"\u8fd0\u884c ",(0,o.kt)("inlineCode",{parentName:"p"},"npm init")," \u547d\u4ee4\u540e\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," \u6587\u4ef6\uff0c\u91cc\u9762\u6709\u4e00\u4e9b\u9ed8\u8ba4\u914d\u7f6e\u3002"),(0,o.kt)("p",null,"\u63a5\u4e0b\u6765\uff0c\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\u6765\u5b89\u88c5 Koa\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install koa@2.13.1\n")),(0,o.kt)("p",null,"\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u73b0\u5728\u5df2\u7ecf\u53ef\u4ee5\u4f7f\u7528 Koa \u4e86\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa4-2--\u521b\u5efa\u4e00\u4e2a-koa-server"},"\u6b65\u9aa4 2 \u2014 \u521b\u5efa\u4e00\u4e2a Koa Server"),(0,o.kt)("p",null,"\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," \u6587\u4ef6\u3002\u7136\u540e\uff0c\u4f7f\u7528\u4f7f\u7528\u4ee3\u7801\u7f16\u8f91\u5668\u6253\u5f00 ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," \u6587\u4ef6\uff0c\u7136\u540e\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"'use strict';\n\nconst Koa = require('koa');\nconst app = new Koa();\n\napp.use(ctx => {\n  ctx.body = 'Hello World';\n});\n\napp.listen(1234);\n")),(0,o.kt)("p",null,"\u4e0a\u9762\u8fd9\u6bb5\u4ee3\u7801\uff0c\u53ef\u4ee5\u521b\u5efa\u51fa\u4e00\u4e2a\u8fd0\u884c\u5728\u7aef\u53e3 ",(0,o.kt)("inlineCode",{parentName:"p"},"1234")," \u4e0a\u7684 Koa \u5e94\u7528\u7a0b\u5e8f\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u4ee3\u7801\u6765\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"node index.js\n")),(0,o.kt)("p",null,"\u7136\u540e\u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:1234")," \u8bbf\u95ee\u5e94\u7528\u7a0b\u5e8f\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa4-3--\u6dfb\u52a0\u8def\u7531\u548c\u89c6\u56fe\u6e32\u67d3"},"\u6b65\u9aa4 3 \u2014 \u6dfb\u52a0\u8def\u7531\u548c\u89c6\u56fe\u6e32\u67d3"),(0,o.kt)("p",null,"\u5c31\u50cf\u4e0a\u9762\u63d0\u5230\u7684\uff0cKoa.js \u5728\u4ea4\u4ed8\u4f7f\u7528\u65f6\u6ca1\u6709\u5305\u542b\u4efb\u4f55\u4e2d\u95f4\u4ef6\uff0c\u800c\u4e14\u4e0e\u5b83\u7684\u524d\u8eab Express \u4e0d\u540c\uff0c\u5b83\u9ed8\u8ba4\u4e0d\u5904\u7406\u8def\u7531\u3002"),(0,o.kt)("p",null,"\u4e3a\u4e86\u5728 Koa \u5e94\u7528\u4e2d\u5b9e\u73b0\u8def\u7531\uff0c\u9700\u8981\u5b89\u88c5\u4e00\u4e2a\u8def\u7531\u4e2d\u95f4\u4ef6 library\uff0c",(0,o.kt)("a",{parentName:"p",href:"https://github.com/koajs/router"},"Koa Router"),"\u3002"),(0,o.kt)("p",null,"\u6253\u5f00\u7ec8\u7aef\u7a97\u53e3\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @koa/router@10.0.0\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u4ee5\u524d\u63a8\u8350\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"koa-router")," \u8fd9\u4e2a\u975e\u5b98\u65b9 package\uff0c\u4f46\u662f\u73b0\u5728\u63a8\u8350\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"@koa/router")," \u8fd9\u4e2a\u5b98\u65b9\u652f\u6301\u7684 package\u3002"),(0,o.kt)("p",null,"\u4e3a\u4e86\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u8def\u7531\uff0c\u9700\u8981\u4fee\u6539 ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," \u6587\u4ef6\u3002"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"'use strict';\n\nconst Koa = require('koa');\nconst Router = require('@koa/router');\n\nconst app = new Koa();\nconst router = new Router();\n\nrouter.get('koa-example', '/', (ctx) => {\n  ctx.body = 'Hello World';\n});\n\napp\n  .use(router.routes())\n  .use(router.allowedMethods());\n\napp.listen(1234);\n")),(0,o.kt)("p",null,"\u8fd9\u6bb5\u4ee3\u7801\u5728\u5e94\u7528\u7a0b\u5e8f\uff08",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:1234"),"\uff09\u7684 base URL \u4e0a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u8def\u7531\uff0c\u7136\u540e\u5c06\u8fd9\u4e2a\u8def\u7531\u6ce8\u518c\u5230 Koa \u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002"),(0,o.kt)("p",null,"\u60f3\u8981\u4e86\u89e3 Koa.js \u5e94\u7528\u7a0b\u5e8f\u4e2d\u8def\u7531\u5b9a\u4e49\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u8bbf\u95ee ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/koajs/router/blob/master/API.md"},"Koa Router library \u6587\u6863"),"\u3002"),(0,o.kt)("p",null,"\u5982\u524d\u6240\u8ff0\uff0cKoa \u662f\u4e00\u4e2a\u7b80\u7ea6\u7684\u6846\u67b6\uff0c\u56e0\u6b64\uff0c\u60f3\u8981\u4f7f\u7528\u6a21\u677f\u5f15\u64ce\u5b9e\u73b0\u89c6\u56fe\u6e32\u67d3\uff0c\u4f60\u5fc5\u987b\u5b89\u88c5\u4e00\u4e2a\u4e2d\u95f4\u4ef6 library\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/koajs/ejs"},"Koa ejs"),"\u3002"),(0,o.kt)("p",null,"\u6253\u5f00\u7ec8\u7aef\u7a97\u53e3\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install koa-ejs@4.3.0\n")),(0,o.kt)("p",null,"\u63a5\u7740\u4fee\u6539 ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," \u6587\u4ef6\uff0c\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u6ce8\u518c\u4f60\u7684\u6a21\u677f\u3002"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"'use strict';\n\nconst Koa = require('koa');\nconst Router = require('@koa/router');\nconst render = require('koa-ejs');\nconst path = require('path');\n\nconst app = new Koa();\nconst router = new Router();\n\nrender(app, {\n  root: path.join(__dirname, 'views'),\n  layout: 'index',\n  viewExt: 'html',\n  cache: false,\n  debug: true\n});\n\nrouter.get('koa-example', '/', (ctx) => {\n  ctx.body = 'Hello World';\n});\n\napp\n  .use(router.routes())\n  .use(router.allowedMethods());\n\napp.listen(1234);\n")),(0,o.kt)("p",null,"\u5728\u4e0a\u9762\u7684\u6a21\u677f\u6ce8\u518c\u4e2d\uff0c\u5b9a\u4e49\u4e86\u89c6\u56fe\u6587\u4ef6\u7684\u6839\u76ee\u5f55\u3001\u89c6\u56fe\u6587\u4ef6\u7684\u6269\u5c55\u540d\u79f0\u3001\u57fa\u7840\u89c6\u56fe\u6587\u4ef6\uff08\u7528\u4e8e\u5176\u4ed6\u89c6\u56fe\u7684\u6269\u5c55\uff09\u3002"),(0,o.kt)("p",null,"\u73b0\u5728\u4f60\u5df2\u7ecf\u6ce8\u518c\u4e86\u4e00\u4e2a\u6a21\u677f\u4e2d\u95f4\u4ef6\uff0c\u4fee\u6539\u4f60\u7684\u8def\u7531\u5b9a\u4e49\u6765\u6e32\u67d3\u4e00\u4e2a\u6a21\u677f\u6587\u4ef6\u3002"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// ...\n\nrouter.get('koa-example', '/', (ctx) => {\n  let koalaFacts = [];\n\n  koalaFacts.push({\n    meta_name: 'Color',\n    meta_value: 'Black and white'\n  });\n\n  koalaFacts.push({\n    meta_name: 'Native Country',\n    meta_value: 'Australia'\n  });\n\n  koalaFacts.push({\n    meta_name: 'Animal Classification',\n    meta_value: 'Mammal'\n  });\n\n  koalaFacts.push({\n    meta_name: 'Life Span',\n    meta_value: '13 - 18 years'\n  });\n\n  koalaFacts.push({\n    meta_name: 'Are they bears?',\n    meta_value: 'No'\n  });\n\n  return ctx.render('index', {\n    attributes: koalaFacts\n  });\n})\n\n// ...\n")),(0,o.kt)("p",null,"base \u8def\u7531\u4f1a\u53bb\u6e32\u67d3 ",(0,o.kt)("inlineCode",{parentName:"p"},"views")," \u76ee\u5f55\u4e0b\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"index.html")," \u6587\u4ef6\u3002"),(0,o.kt)("p",null,"\u73b0\u5728\uff0c\u521b\u5efa\u8fd9\u4e2a\u76ee\u5f55\u548c\u6587\u4ef6\u3002\u6253\u5f00 ",(0,o.kt)("inlineCode",{parentName:"p"},"index.html")," \u5e76\u6dfb\u52a0\u4ee5\u4e0b\u51e0\u884c\u4ee3\u7801\uff1a"),(0,o.kt)("p",null,"views/index.html"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<h2>Koala - a directory Koala of attributes</h2>\n<ul class="list-group">\n  <% attributes.forEach( function(attribute) { %>\n    <li class="list-group-item">\n      <%= attribute.meta_name %> - <%= attribute.meta_value %>\n    </li>\n  <% }) %>\n</ul>\n')),(0,o.kt)("p",null,"\u73b0\u5728\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\uff0c\u7136\u540e\u5728 web browser \u4e2d\u89c2\u5bdf\u65f6\uff0c\u4f1a\u663e\u793a\u5982\u4e0b\u5185\u5bb9\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"OutputKoala - a directory Koala of attributes\nColor - Black and white\nNative Country - Australia\nAnimal Classification - Mammal\nLife Span - 13 - 18 years\nAre they bears? - No\n")),(0,o.kt)("p",null,"\u60f3\u8981\u4e86\u89e3 ",(0,o.kt)("inlineCode",{parentName:"p"},"koa-ejs")," \u6a21\u677f\u4e2d\u95f4\u4ef6\u7684\u66f4\u591a\u9009\u9879\uff0c\u8bf7\u8bbf\u95ee ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/koajs/ejs"},"koa-ejs library \u6587\u6863"),"\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa4-4--\u5904\u7406\u9519\u8bef\u548c\u54cd\u5e94"},"\u6b65\u9aa4 4 \u2014 \u5904\u7406\u9519\u8bef\u548c\u54cd\u5e94"),(0,o.kt)("p",null,"Koa handles errors by defining an error middleware early in your entry point file. The error middleware must be defined early because only errors from middleware defined after the error middleware will be caught."),(0,o.kt)("p",null,"Using your ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," file as an example, make the following changes to the code:"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"'use strict';\n\nconst Koa = require('koa');\nconst Router = require('@koa/router');\nconst render = require('koa-ejs');\nconst path = require('path');\n\nconst app = new Koa();\nconst router = new Router();\n\napp.use(async (ctx, next) => {\n  try {\n    await next()\n  } catch(err) {\n    console.log(err.status)\n    ctx.status = err.status || 500;\n    ctx.body = err.message;\n  }\n});\n\n// ...\n")),(0,o.kt)("p",null,"This block of code will catch any error thrown during the execution of your application."),(0,o.kt)("p",null,"You can test this by throwing an error in the function body of the route you defined:"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// ...\n\nrouter.get('error', '/error', (ctx) => {\n  ctx.throw(500, 'internal server error');\n});\n\napp\n  .use(router.routes())\n  .use(router.allowedMethods());\n\napp.listen(1234);\n")),(0,o.kt)("p",null,"Now, when running the application and observing ",(0,o.kt)("inlineCode",{parentName:"p"},"/error")," in a web browser will display the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Outputinternal server error\n")),(0,o.kt)("p",null,"The Koa response object is usually embedded in its context object. Using route definition, let\u2019s show an example of setting responses:"),(0,o.kt)("p",null,"index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// ...\n\nrouter.get('status', '/status', (ctx) => {\n  ctx.status = 200;\n  ctx.body   = 'ok';\n})\n\napp\n  .use(router.routes())\n  .use(router.allowedMethods());\n\napp.listen(1234);\n")),(0,o.kt)("p",null,"Now, when running the application and observing ",(0,o.kt)("inlineCode",{parentName:"p"},"/status")," in a web browser will display the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Output\nok\n")),(0,o.kt)("p",null,"Your application now handles errors and responses."),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"In this article, you had a brief introduction to Koa and how to implement some common functionalities in a Koa project. Koa is a minimalist and flexible framework that can be extended to more functionality than this article has shown. Because of its futuristic similarity to Express, some have even described it as Express 5.0 in spirit."))}d.isMDXComponent=!0}}]);