(self.webpackChunk_site_blog=self.webpackChunk_site_blog||[]).push([[8781],{3905:function(t,e,n){"use strict";n.d(e,{Zo:function(){return c},kt:function(){return d}});var o=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var p=o.createContext({}),s=function(t){var e=o.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},c=function(t){var e=s(t.components);return o.createElement(p.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return o.createElement(o.Fragment,{},e)}},h=o.forwardRef((function(t,e){var n=t.components,r=t.mdxType,a=t.originalType,p=t.parentName,c=l(t,["components","mdxType","originalType","parentName"]),h=s(n),d=r,k=h["".concat(p,".").concat(d)]||h[d]||u[d]||a;return n?o.createElement(k,i(i({ref:e},c),{},{components:n})):o.createElement(k,i({ref:e},c))}));function d(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var p in e)hasOwnProperty.call(e,p)&&(l[p]=e[p]);l.originalType=t,l.mdxType="string"==typeof t?t:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7455:function(t,e,n){"use strict";n.r(e),n.d(e,{frontMatter:function(){return l},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return c},default:function(){return h}});var o=n(2122),r=n(9756),a=(n(7294),n(3905)),i=["components"],l={id:"frontend_route_and_history_api",title:"\u7406\u89e3\u524d\u7aef\u8def\u7531 - \u4ec0\u4e48\u662f History API\uff1f"},p=void 0,s={unversionedId:"core/application/frontend_route_and_history_api",id:"core/application/frontend_route_and_history_api",isDocsHomePage:!1,title:"\u7406\u89e3\u524d\u7aef\u8def\u7531 - \u4ec0\u4e48\u662f History API\uff1f",description:"\u51c6\u5907\u9636\u6bb5",source:"@site/docs/core/application/frontend_route_and_history_api.md",sourceDirName:"core/application",slug:"/core/application/frontend_route_and_history_api",permalink:"/blog/docs/core/application/frontend_route_and_history_api",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/core/application/frontend_route_and_history_api.md",version:"current",frontMatter:{id:"frontend_route_and_history_api",title:"\u7406\u89e3\u524d\u7aef\u8def\u7531 - \u4ec0\u4e48\u662f History API\uff1f"}},c=[{value:"\u51c6\u5907\u9636\u6bb5",id:"\u51c6\u5907\u9636\u6bb5",children:[{value:"\u5728\u5168\u5c40\u73af\u5883\u5b89\u88c5 serve",id:"\u5728\u5168\u5c40\u73af\u5883\u5b89\u88c5-serve",children:[]},{value:"\u521b\u5efa\u4e00\u4e2a index.html",id:"\u521b\u5efa\u4e00\u4e2a-indexhtml",children:[]},{value:"\u4ee5 spa \u65b9\u5f0f\u8fd0\u884c index.html",id:"\u4ee5-spa-\u65b9\u5f0f\u8fd0\u884c-indexhtml",children:[]},{value:"\u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u7684\u9875\u9762",id:"\u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u7684\u9875\u9762",children:[]}]},{value:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u5c5e\u6027",id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u5c5e\u6027",children:[{value:"\u4ec0\u4e48\u662f history\uff1f",id:"\u4ec0\u4e48\u662f-history\uff1f",children:[]},{value:"\u4ec0\u4e48\u662f History \u548c History.prototype\uff1f",id:"\u4ec0\u4e48\u662f-history-\u548c-historyprototype\uff1f",children:[]},{value:"history \u5bf9\u8c61\u548c History \u5b9e\u4f8b\u5bf9\u8c61\u662f\u901a\u8fc7 __proto__ \u5b9e\u73b0\u7684\u7684\u7ee7\u627f\u5173\u7cfb",id:"history-\u5bf9\u8c61\u548c-history-\u5b9e\u4f8b\u5bf9\u8c61\u662f\u901a\u8fc7-__proto__-\u5b9e\u73b0\u7684\u7684\u7ee7\u627f\u5173\u7cfb",children:[]}]},{value:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e0d\u4fee\u6539\u6808\u7684\u65b9\u6cd5",id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e0d\u4fee\u6539\u6808\u7684\u65b9\u6cd5",children:[{value:"history.go([delta])",id:"historygodelta",children:[]},{value:"history.forward()",id:"historyforward",children:[]},{value:"history.back()",id:"historyback",children:[]}]},{value:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4fee\u6539\u6808\u7684\u65b9\u6cd5",id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4fee\u6539\u6808\u7684\u65b9\u6cd5",children:[{value:"\u65e0\u6cd5\u5b9e\u73b0\u51fa\u6808",id:"\u65e0\u6cd5\u5b9e\u73b0\u51fa\u6808",children:[]},{value:"history.pushState()",id:"historypushstate",children:[]},{value:"history.replaceState()",id:"historyreplacestate",children:[]}]},{value:"History API \u63d0\u4f9b\u7684\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u5237\u65b0\u9875\u9762",id:"history-api-\u63d0\u4f9b\u7684\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u5237\u65b0\u9875\u9762",children:[]},{value:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e8b\u4ef6",id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e8b\u4ef6",children:[{value:"popstate \u4e8b\u4ef6",id:"popstate-\u4e8b\u4ef6",children:[]},{value:"\u8c01\u89e6\u53d1 popstate \u4e8b\u4ef6\uff1f",id:"\u8c01\u89e6\u53d1-popstate-\u4e8b\u4ef6\uff1f",children:[]}]}],u={toc:c};function h(t){var e=t.components,n=(0,r.Z)(t,i);return(0,a.kt)("wrapper",(0,o.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u51c6\u5907\u9636\u6bb5"},"\u51c6\u5907\u9636\u6bb5"),(0,a.kt)("h3",{id:"\u5728\u5168\u5c40\u73af\u5883\u5b89\u88c5-serve"},"\u5728\u5168\u5c40\u73af\u5883\u5b89\u88c5 serve"),(0,a.kt)("p",null,"\u4e3a\u4e86\u66f4\u597d\u5730\u6f14\u793a\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7 npm\uff0c\u5728\u5168\u5c40\u73af\u5883\u5b89\u88c5 serve\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ npm install -g serve\n")),(0,a.kt)("h3",{id:"\u521b\u5efa\u4e00\u4e2a-indexhtml"},"\u521b\u5efa\u4e00\u4e2a index.html"),(0,a.kt)("p",null,"\u5728\u4e00\u4e2a example \u76ee\u5f55\u4e0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ mkdir example\n$ cd example\n$ vi index.html\n\n# \u8f93\u5165\u5982\u4e0b\u5185\u5bb9\u540e\u4fdd\u5b58\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset='UTF-8'>\n  <title>History API</title>\n</head>\n<body>\n  \x3c!-- \u8fd9\u91cc\u662f\u4e00\u4e9b\u793a\u4f8b\u4ee3\u7801 --\x3e\n</body>\n</html>\n")),(0,a.kt)("h3",{id:"\u4ee5-spa-\u65b9\u5f0f\u8fd0\u884c-indexhtml"},"\u4ee5 spa \u65b9\u5f0f\u8fd0\u884c index.html"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ serve -s\n")),(0,a.kt)("p",null,"\u6b64\u65f6\u5c31\u4ee5 spa \u65b9\u5f0f\uff0c\u6253\u5f00\u4e86\u4e00\u4e2a HTML \u9875\u9762\u3002"),(0,a.kt)("h3",{id:"\u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u7684\u9875\u9762"},"\u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u7684\u9875\u9762"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4e0d\u8981\u5728\u6d4f\u89c8\u5668\u8f93\u5165 URL \u521b\u5efa\u521d\u59cb\u9875\u9762\uff0c\u5426\u5219 history \u6808\u4e2d\u4f1a\u591a\u4e00\u6761\u8bb0\u5f55\u3002")),(0,a.kt)("p",null,"\u6211\u4eec\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"window.open('http://localhost:5000')")," \u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u7684\u9875\u9762\u3002"),(0,a.kt)("p",null,"\u6b64\u65f6 history \u6808\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"init <--\n")),(0,a.kt)("p",null,"\u5e76\u4e14\u524d\u8fdb\u548c\u540e\u9000\u6309\u94ae\u90fd\u4e0d\u53ef\u70b9\u51fb\uff0c\u8fd9\u662f\u6211\u4eec\u60f3\u8981\u7684\u521d\u59cb\u9875\u9762\u3002"),(0,a.kt)("h2",{id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u5c5e\u6027"},"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u5c5e\u6027"),(0,a.kt)("h3",{id:"\u4ec0\u4e48\u662f-history\uff1f"},"\u4ec0\u4e48\u662f history\uff1f"),(0,a.kt)("p",null,"history \u662f\u4e2a\u6808\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u7406\u89e3\u4e3a\u4e00\u4e2a\u6808\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c push, pop \u6765\u6dfb\u52a0\u548c\u5220\u9664\u8bb0\u5f55\u3002"),(0,a.kt)("p",null,"\u73b0\u5728\uff0c\u5728\u63a7\u5236\u53f0\u6253\u5370 history\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},'console.log(history)\n\n{\n  length: 1\n  scrollRestoration: "auto"\n  state: null\n  __proto__: History\n}\n')),(0,a.kt)("p",null,"\u53ef\u4ee5\u770b\u51fa\uff1a",(0,a.kt)("strong",{parentName:"p"},"history \u5b9e\u4f8b\u662f\u4e00\u4e2a\u6808\u7ed3\u6784\uff0c\u6709 length \u5c5e\u6027\uff0c\u5e76\u4e14\u5176\u901a\u8fc7 ","_","_proto","_","_ \u7ee7\u627f History \u5b9e\u4f8b\u5bf9\u8c61\u3002")),(0,a.kt)("h3",{id:"\u4ec0\u4e48\u662f-history-\u548c-historyprototype\uff1f"},"\u4ec0\u4e48\u662f History \u548c History.prototype\uff1f"),(0,a.kt)("p",null,"History \u662f\u4e00\u4e2a\u6784\u9020\u51fd\u6570\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"console.log(History)\n\n\u0192 History() { [native code] }\n")),(0,a.kt)("p",null,"History.prototype \u662f\u4e00\u4e2a\u539f\u578b\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},'console.log(History.prototype)\n\n{\n  back: \u0192 back()\n  forward: \u0192 forward()\n  go: \u0192 go()\n  length: (...)\n  pushState: \u0192 pushState()\n  replaceState: \u0192 replaceState()\n  scrollRestoration: (...)\n  state: (...)\n  constructor: \u0192 History()\n  Symbol(Symbol.toStringTag): "History"\n  get length: \u0192 length()\n  get scrollRestoration: \u0192 scrollRestoration()\n  set scrollRestoration: \u0192 scrollRestoration()\n  get state: \u0192 state()\n  __proto__: Object\n}\n')),(0,a.kt)("h3",{id:"history-\u5bf9\u8c61\u548c-history-\u5b9e\u4f8b\u5bf9\u8c61\u662f\u901a\u8fc7-__proto__-\u5b9e\u73b0\u7684\u7684\u7ee7\u627f\u5173\u7cfb"},"history \u5bf9\u8c61\u548c History \u5b9e\u4f8b\u5bf9\u8c61\u662f\u901a\u8fc7 ","_","_proto","_","_ \u5b9e\u73b0\u7684\u7684\u7ee7\u627f\u5173\u7cfb"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"new History()")," \u521b\u5efa\u51fa\u6765\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u4f1a\u88ab ",(0,a.kt)("inlineCode",{parentName:"p"},"history \u5bf9\u8c61")," \u901a\u8fc7 ","_","_proto","_","_ \u7ee7\u627f\u8fc7\u53bb\u3002"),(0,a.kt)("p",null,"\u56e0\u6b64 history \u53ef\u4ee5\u76f4\u63a5\u8c03\u7528 History.prototype \u4e0a\u9762\u7684 go(), back() \u65b9\u6cd5\u3002"),(0,a.kt)("h2",{id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e0d\u4fee\u6539\u6808\u7684\u65b9\u6cd5"},"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e0d\u4fee\u6539\u6808\u7684\u65b9\u6cd5"),(0,a.kt)("p",null,"\u6ce8\u610f ",(0,a.kt)("inlineCode",{parentName:"p"},"history.go([delta])"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"history.forward()"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"history.back()")," \u8fd9\u4e9b\u65b9\u6cd5"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u90fd\u662f\u5f02\u6b65\u51fd\u6570"),(0,a.kt)("li",{parentName:"ol"},"\u90fd ",(0,a.kt)("inlineCode",{parentName:"li"},"\u89e6\u53d1 popstate \u4e8b\u4ef6"),"\u3002")),(0,a.kt)("p",null,"\u6ce8\u610f\u8fd9\u91cc\u90fd\u662f\u5f02\u6b65\u51fd\u6570\uff0c",(0,a.kt)("strong",{parentName:"p"},"\u4e0d\u8981\u76f4\u63a5\u8fde\u7eed\u8c03\u7528"),"\uff0c\u907f\u514d\u51fa\u73b0\u610f\u60f3\u4e0d\u5230\u7684\u7ed3\u679c\u3002"),(0,a.kt)("h3",{id:"historygodelta"},(0,a.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/go"},"history.go([delta])")),(0,a.kt)("p",null,"\u4e0d\u4fee\u6539\u6808\uff0c\u76f8\u5bf9\u4e8e\u5f53\u524d\u5728 history \u6808\u4e2d\u7684\u4f4d\u7f6e\uff0c\u5411\u524d\u6216\u5411\u540e\u79fb\u52a8\u3002"),(0,a.kt)("h3",{id:"historyforward"},(0,a.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/forward"},"history.forward()")),(0,a.kt)("p",null,"\u7b49\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"history.go(1)"),"\u3002"),(0,a.kt)("p",null,"\u4e0d\u4fee\u6539\u6808\uff0c\u800c\u662f\u5c06\u6808\u6307\u9488\u5f80\u540e\u6307\u5411\u4e00\u4f4d\u3002"),(0,a.kt)("h3",{id:"historyback"},(0,a.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/back"},"history.back()")),(0,a.kt)("p",null,"\u7b49\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"history.go(-1)"),"\u3002"),(0,a.kt)("p",null,"\u4e0d\u4fee\u6539\u6808\uff0c\u800c\u662f\u5c06\u6808\u6307\u9488\u5f80\u524d\u6307\u5411\u4e00\u4f4d\u3002"),(0,a.kt)("h2",{id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4fee\u6539\u6808\u7684\u65b9\u6cd5"},"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4fee\u6539\u6808\u7684\u65b9\u6cd5"),(0,a.kt)("p",null,"\u6ce8\u610f ",(0,a.kt)("inlineCode",{parentName:"p"},"history.pushState()"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"history.replaceState()")," \u8fd9\u4e9b\u65b9\u6cd5"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u90fd\u662f\u5f02\u6b65\u51fd\u6570"),(0,a.kt)("li",{parentName:"ol"},"\u90fd ",(0,a.kt)("inlineCode",{parentName:"li"},"\u4e0d\u89e6\u53d1 popstate \u4e8b\u4ef6"),"\u3002")),(0,a.kt)("p",null,"\u6ce8\u610f\u8fd9\u91cc\u90fd\u662f\u5f02\u6b65\u51fd\u6570\uff0c",(0,a.kt)("strong",{parentName:"p"},"\u4e0d\u8981\u76f4\u63a5\u8fde\u7eed\u8c03\u7528"),"\uff0c\u907f\u514d\u51fa\u73b0\u610f\u60f3\u4e0d\u5230\u7684\u7ed3\u679c\u3002"),(0,a.kt)("h3",{id:"\u65e0\u6cd5\u5b9e\u73b0\u51fa\u6808"},"\u65e0\u6cd5\u5b9e\u73b0\u51fa\u6808"),(0,a.kt)("p",null,"\u6211\u4eec\u5728\u4e0a\u9762\u4e86\u89e3\u5230 history \u662f\u4e00\u4e2a\u6808\u3002"),(0,a.kt)("p",null,"\u6808\u7ed3\u6784\u662f\u5177\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"push \u5165\u6808")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"pop \u51fa\u6808")," \u80fd\u529b\u7684\u3002"),(0,a.kt)("p",null,"\u4f46\u662f\u6d4f\u89c8\u5668\u8bbe\u8ba1\u7684 history \u6808\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"\u5141\u8bb8 push \u5165\u6808"),"\uff0c\u4f46 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u4e0d\u5141\u8bb8 pop \u51fa\u6808"),"\uff0c\u4ec5\u989d\u5916\u589e\u52a0\u4e86\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"replace \u66ff\u6362\u6307\u9488\u6307\u5411\u7684\u6808\u8bb0\u5f55")," \u7684\u80fd\u529b\u3002"),(0,a.kt)("h3",{id:"historypushstate"},(0,a.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/pushState"},"history.pushState()")),(0,a.kt)("p",null,"\u6211\u4eec\u8c03\u7528 history.pushState \u63a8\u5165\u4e00\u6761\u8bb0\u5f55\uff0c\u518d\u6b21\u63a7\u5236\u53f0\u6253\u5370 history\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"history.pushState({page: 1}, 'title 1', '/page1')\nconsole.log(history)\n\n{\n  length: 2\n  scrollRestoration: \"auto\"\n  state: {page: 1}\n  __proto__: History\n}\n")),(0,a.kt)("p",null,"\u53ef\u4ee5\u770b\u51fa\uff0c\u6808\u7684\u957f\u5ea6\u53d8\u4e3a 2\uff0c\u800c\u4e14\u6b64\u65f6\u7684 state \u662f\u6211\u4eec\u521a\u624d\u8c03\u7528 pushState \u4f20\u9012\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u503c {page: 1}\u3002"),(0,a.kt)("p",null,"\u6b64\u65f6 history \u6808\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"/page1 <--\ninit\n")),(0,a.kt)("p",null,"\u6211\u4eec\u7ee7\u7eed\u505a\u5982\u4e0b\u64cd\u4f5c\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8c03\u7528 history.back() \u56de\u5230 init \u8bb0\u5f55\uff0c\u6253\u5370 state\uff0c\u5f97\u5230 null\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u8c03\u7528 history.forward() \u56de\u5230 /page1 \u8fd9\u6761\u8bb0\u5f55\uff0c\u6253\u5370 state\uff0c\u5f97\u5230 {page: 1}\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5237\u65b0\u9875\u9762\uff0c\u6253\u5370 state\uff0c\u5f97\u5230 {page: 1}\u3002")),(0,a.kt)("p",null,"\u4e5f\u5c31\u662f\u8bf4\uff0cstate \u662f\u8ddf\u7740 history \u6808\u5b58\u50a8\u7684\uff0c\u5237\u65b0\u9875\u9762\u4e5f\u4e0d\u4f1a\u4e22\u5931\u3002"),(0,a.kt)("h3",{id:"historyreplacestate"},(0,a.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState"},"history.replaceState()")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"UTF-8\">\n    <title>History API</title>\n  </head>\n  <body>\n    <button onclick=\"stackPush()\">stack push</button>\n    <button onclick=\"stackBack()\">stack back</button>\n    <button onclick=\"stackReplace()\">stack replace</button>\n    <script>\n      window.stackPush = function () {\n        history.pushState({page: 1}, 'title 1', '/page1')\n        history.pushState({page: 2}, 'title 2', '/page2')\n      }\n      window.stackBack = function () {\n        history.back()\n      }\n      window.stackReplace = function () {\n         history.replaceState({page: 3}, 'title 3', '/page3')\n      }\n    <\/script>\n  </body>\n</html>\n")),(0,a.kt)("p",null,"\u70b9\u51fb stack push \u6309\u94ae\u540e\uff0chistory \u6808\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"/page2 <--\n/page1\ninit\n")),(0,a.kt)("p",null,"\u70b9\u51fb stack back \u6309\u94ae\u548c stack replace \u6309\u94ae\u540e\uff0chistory \u6808\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"/page2\n/page3 <--\ninit\n")),(0,a.kt)("p",null,"\u8fd9\u8bf4\u660e history.replaceState() \u662f\u66ff\u6362\u5f53\u524d\u6307\u9488\u6307\u5411\u7684\u8bb0\u5f55\uff0c\u800c\u4e0d\u5f71\u54cd\u5176\u4ed6\u7684\u8bb0\u5f55\u3002"),(0,a.kt)("h2",{id:"history-api-\u63d0\u4f9b\u7684\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u5237\u65b0\u9875\u9762"},"History API \u63d0\u4f9b\u7684\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u5237\u65b0\u9875\u9762"),(0,a.kt)("p",null,"\u6ce8\u610f\u4ee5\u4e0b\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"History API \u63d0\u4f9b\u7684\u65b9\u6cd5\uff0c\u53ea\u662f\u4fee\u6539\u6808\u548c\u64cd\u4f5c\u6307\u9488\uff0c\u90fd\u4e0d\u4f1a\u5237\u65b0\u9875\u9762\u3002"),(0,a.kt)("li",{parentName:"ol"},"location.href \u8d4b\u503c\uff0c\u65e2 push \u5165\u6808\uff0c\u4e5f\u5237\u65b0\u9875\u9762\u3002")),(0,a.kt)("p",null,"\u6240\u4ee5\u4f7f\u7528 Vue, React \u7b49\u6846\u67b6\u65f6\uff0c\u8981\u8bbe\u8ba1\u597d history \u6808\u7684\u4ea4\u4e92\uff0c\u614e\u7528 location.href \u8df3\u8f6c\u9875\u9762\uff0c\u907f\u514d\u9020\u6210\u9875\u9762\u5237\u65b0\u3002"),(0,a.kt)("h2",{id:"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e8b\u4ef6"},"\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u4e8b\u4ef6"),(0,a.kt)("h3",{id:"popstate-\u4e8b\u4ef6"},(0,a.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/popstate_event"},"popstate \u4e8b\u4ef6")),(0,a.kt)("p",null,"\u6d4f\u89c8\u5668\u53ea\u63d0\u4f9b\u4e00\u4e2a popstate \u4e8b\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528\u4e24\u79cd\u65b9\u5f0f\u76d1\u542c\u6b64\u4e8b\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"window.addEventListener('popstate', (event) => {\n  console.log(event)\n}, false)\n// \u6216\u8005\nwindow.onpopstate = (event) => {\n  console.log(event)\n}\n")),(0,a.kt)("p",null,"\u5efa\u8bae\u4f7f\u7528 window.addEventListener('popstate', function(event) {}, false) \u65b9\u5f0f\u3002"),(0,a.kt)("h3",{id:"\u8c01\u89e6\u53d1-popstate-\u4e8b\u4ef6\uff1f"},"\u8c01\u89e6\u53d1 popstate \u4e8b\u4ef6\uff1f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"UTF-8\">\n    <title>History API</title>\n  </head>\n  <body>\n    <button onclick=\"stackTake()\">stack take</button>\n    <button onclick=\"stackBack()\">stack back</button>\n    <button onclick=\"stackForward()\">stack forward</button>\n    <button onclick=\"stackGo()\">stack go</button>\n    <button onclick=\"stackPush()\">stack push</button>\n    <button onclick=\"stackReplace()\">stack replace</button>\n    <script>\n      // \u5148\u76d1\u542c popstate \u4e8b\u4ef6\n      window.addEventListener('popstate', (event) => {\n        console.log(event)\n      }, false)\n\n      // \u518d\u5411 history \u6808\u4e2d\u6dfb\u52a0\u4e09\u6761\u8bb0\u5f55\uff0c\u5e76\u4e14\u6307\u9488\u6307\u5411\u5230\u6808\u9876\n      window.stackTake = function () {\n        history.pushState({page: 1}, 'title 1', '/page1')\n        history.pushState({page: 2}, 'title 2', '/page2')\n        history.pushState({page: 3}, 'title 3', '/page3')\n      }\n      window.stackBack = function () {\n        history.back()\n      }\n      window.stackForward = function () {\n        history.forward()\n      }\n      window.stackGo = function () {\n        history.go(-2)\n      }\n      window.stackPush = function () {\n        history.pushState({page: 4}, 'title 4', '/page4')\n      }\n      window.stackReplace = function () {\n        history.replaceState({page: 5}, 'title 5', '/page5')\n      }\n    <\/script>\n  </body>\n</html>\n")),(0,a.kt)("p",null,"\u901a\u8fc7\u9010\u4e2a\u70b9\u51fb\u4e0a\u9762\u7684\u6309\u94ae\uff0c\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u5230\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u6240\u6709\u4fee\u6539 history \u6808\u7684\u65b9\u6cd5\u3001\u4e0d\u4fee\u6539\u6307\u9488\u7684\u65b9\u6cd5\uff0c\u90fd\u4e0d\u4f1a\u89e6\u53d1 popstate \u4e8b\u4ef6\u3002\u4f8b\u5982 ",(0,a.kt)("strong",{parentName:"li"},"\u8c03\u7528 ",(0,a.kt)("inlineCode",{parentName:"strong"},"history.pushState()")," \u6216 ",(0,a.kt)("inlineCode",{parentName:"strong"},"history.replaceState()")," \u90fd\u4e0d\u4f1a\u89e6\u53d1 popstate \u4e8b\u4ef6"),"\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u6240\u6709\u4e0d\u4fee\u6539 history \u6808\u3001\u4fee\u6539\u6307\u9488\u7684\u65b9\u6cd5\uff0c\u90fd\u4f1a\u89e6\u53d1 popstate \u4e8b\u4ef6\u3002\u771f\u6b63\u89e6\u53d1 popstate \u4e8b\u4ef6\u7684\u662f ",(0,a.kt)("inlineCode",{parentName:"li"},"history.back()"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"history.forward()"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"history.go()"),"\u3002")),(0,a.kt)("p",null,"\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u7528\u6237\u5728\u6d4f\u89c8\u5668\u70b9\u51fb\u524d\u8fdb\u548c\u540e\u9000\u6309\u94ae")," \u6216\u8005 ",(0,a.kt)("inlineCode",{parentName:"p"},"JavaScript \u4ee3\u7801\u4e2d\u8c03\u7528 history.back(), history.forward(), history.go()")," \u8fd9\u4e24\u79cd\u60c5\u51b5\u4f1a\u89e6\u53d1 popstate \u4e8b\u4ef6\u3002"))}h.isMDXComponent=!0}}]);