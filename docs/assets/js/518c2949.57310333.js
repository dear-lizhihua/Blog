(self.webpackChunk_site_blog=self.webpackChunk_site_blog||[]).push([[3403],{3905:function(e,a,t){"use strict";t.d(a,{Zo:function(){return d},kt:function(){return p}});var n=t(7294);function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){o(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,n,o=function(e,a){if(null==e)return{};var t,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=n.createContext({}),c=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},d=function(e){var a=c(e.components);return n.createElement(s.Provider,{value:a},e.children)},h={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(t),p=o,m=u["".concat(s,".").concat(p)]||u[p]||h[p]||r;return t?n.createElement(m,i(i({ref:a},d),{},{components:t})):n.createElement(m,i({ref:a},d))}));function p(e,a){var t=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=u;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=t[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}u.displayName="MDXCreateElement"},261:function(e,a,t){"use strict";t.r(a),t.d(a,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return d},default:function(){return u}});var n=t(2122),o=t(9756),r=(t(7294),t(3905)),i=["components"],l={},s=void 0,c={unversionedId:"cloud/what_is_loading_balancing_en",id:"cloud/what_is_loading_balancing_en",isDocsHomePage:!1,title:"what_is_loading_balancing_en",description:"Introduction",source:"@site/docs/cloud/what_is_loading_balancing_en.md",sourceDirName:"cloud",slug:"/cloud/what_is_loading_balancing_en",permalink:"/blog/docs/cloud/what_is_loading_balancing_en",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/cloud/what_is_loading_balancing_en.md",version:"current",frontMatter:{}},d=[{value:"Introduction",id:"introduction",children:[]},{value:"What kind of traffic can load balancers handle?",id:"what-kind-of-traffic-can-load-balancers-handle",children:[]},{value:"How does the load balancer choose the backend server?",id:"how-does-the-load-balancer-choose-the-backend-server",children:[{value:"Health Checks",id:"health-checks",children:[]},{value:"Load Balancing Algorithms",id:"load-balancing-algorithms",children:[]},{value:"How do load balancers handle state?",id:"how-do-load-balancers-handle-state",children:[]}]},{value:"Redundant Load Balancers",id:"redundant-load-balancers",children:[]},{value:"Conclusion",id:"conclusion",children:[{value:"DigitalOcean\u2019s Load Balancing Service",id:"digitaloceans-load-balancing-service",children:[]},{value:"HAProxy",id:"haproxy",children:[]},{value:"Nginx",id:"nginx",children:[]}]}],h={toc:d};function u(e){var a=e.components,t=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},h,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h3",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Load balancing is a key component of highly-available infrastructures commonly used to improve the performance and reliability of web sites, applications, databases and other services by distributing the workload across multiple servers."),(0,r.kt)("p",null,"A web infrastructure with no load balancing might look something like the following:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://assets.digitalocean.com/articles/HAProxy/web_server.png",alt:"web_server"})),(0,r.kt)("p",null,"In this example, the user connects directly to the web server, at ",(0,r.kt)("em",{parentName:"p"},"yourdomain.com"),". If this single web server goes down, the user will no longer be able to access the website. In addition, if many users try to access the server simultaneously and it is unable to handle the load, they may experience slow load times or may be unable to connect at all."),(0,r.kt)("p",null,"This single point of failure can be mitigated by introducing a load balancer and at least one additional web server on the backend. Typically, all of the backend servers will supply identical content so that users receive consistent content regardless of which server responds."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://assets.digitalocean.com/articles/high-availability/Diagram_2.png",alt:"Diagram 01: Load Balancers / Top-to-bottom"})),(0,r.kt)("p",null,"In the example illustrated above, the user accesses the load balancer, which forwards the user\u2019s request to a backend server, which then responds directly to the user\u2019s request. In this scenario, the single point of failure is now the load balancer itself. This can be mitigated by introducing a second load balancer, but before we discuss that, let\u2019s explore how load balancers work."),(0,r.kt)("h2",{id:"what-kind-of-traffic-can-load-balancers-handle"},"What kind of traffic can load balancers handle\\?"),(0,r.kt)("p",null,"Load balancer administrators create forwarding rules for four main types of traffic:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"HTTP")," \u2014 Standard HTTP balancing directs requests based on standard HTTP mechanisms. The Load Balancer sets the ",(0,r.kt)("inlineCode",{parentName:"li"},"X-Forwarded-For"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"X-Forwarded-Proto"),", and ",(0,r.kt)("inlineCode",{parentName:"li"},"X-Forwarded-Port")," headers to give the backends information about the original request."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"HTTPS")," \u2014 HTTPS balancing functions the same as HTTP balancing, with the addition of encryption. Encryption is handled in one of two ways: either with ",(0,r.kt)("strong",{parentName:"li"},"SSL passthrough")," which maintains encryption all the way to the backend or with ",(0,r.kt)("strong",{parentName:"li"},"SSL termination")," which places the decryption burden on the load balancer but sends the traffic unencrypted to the back end."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"TCP")," \u2014 For applications that do not use HTTP or HTTPS, TCP traffic can also be balanced. For example, traffic to a database cluster could be spread across all of the servers."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"UDP")," \u2014 More recently, some load balancers have added support for load balancing core internet protocols like DNS and syslogd that use UDP.")),(0,r.kt)("p",null,"These forwarding rules will define the protocol and port on the load balancer itself and map them to the protocol and port the load balancer will use to route the traffic to on the backend."),(0,r.kt)("h2",{id:"how-does-the-load-balancer-choose-the-backend-server"},"How does the load balancer choose the backend server\\?"),(0,r.kt)("p",null,"Load balancers choose which server to forward a request to based on a combination of two factors. They will first ensure that any server they can choose is actually responding appropriately to requests and then use a pre-configured rule to select from among that healthy pool."),(0,r.kt)("h3",{id:"health-checks"},"Health Checks"),(0,r.kt)("p",null,"Load balancers should only forward traffic to \u201chealthy\u201d backend servers. To monitor the health of a backend server, health checks regularly attempt to connect to backend servers using the protocol and port defined by the forwarding rules to ensure that servers are listening. If a server fails a health check, and therefore is unable to serve requests, it is automatically removed from the pool, and traffic will not be forwarded to it until it responds to the health checks again."),(0,r.kt)("h3",{id:"load-balancing-algorithms"},"Load Balancing Algorithms"),(0,r.kt)("p",null,"The load balancing algorithm that is used determines which of the healthy servers on the backend will be selected. A few of the commonly used algorithms are:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Round Robin")," \u2014 Round Robin means servers will be selected sequentially. The load balancer will select the first server on its list for the first request, then move down the list in order, starting over at the top when it reaches the end."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Least Connections")," \u2014 Least Connections means the load balancer will select the server with the least connections and is recommended when traffic results in longer sessions."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Source")," \u2014 With the Source algorithm, the load balancer will select which server to use based on a hash of the source IP of the request, such as the visitor\u2019s IP address. This method ensures that a particular user will consistently connect to the same server."),(0,r.kt)("p",null,"The algorithms available to administrators vary depending on the specific load balancing technology in use."),(0,r.kt)("h3",{id:"how-do-load-balancers-handle-state"},"How do load balancers handle state\\?"),(0,r.kt)("p",null,"Some applications require that a user continues to connect to the same backend server. A Source algorithm creates an affinity based on client IP information. Another way to achieve this at the web application level is through ",(0,r.kt)("strong",{parentName:"p"},"sticky sessions"),", where the load balancer sets a cookie and all of the requests from that session are directed to the same physical server."),(0,r.kt)("h2",{id:"redundant-load-balancers"},"Redundant Load Balancers"),(0,r.kt)("p",null,"To remove the load balancer as a single point of failure, a second load balancer can be connected to the first to form a cluster, where each one monitors the others\u2019 health. Each one is equally capable of failure detection and recovery."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://assets.digitalocean.com/articles/high-availability/Diagram_1.png",alt:"Diagram 02: Cluster / Distributed"})),(0,r.kt)("p",null,"In the event the main load balancer fails, DNS must take users to the to the second load balancer. Because DNS changes can take a considerable amount of time to be propagated on the Internet and to make this failover automatic, many administrators will use systems that allow for flexible IP address remapping, such as ",(0,r.kt)("a",{parentName:"p",href:"https://www.digitalocean.com/community/tutorials/how-to-use-floating-ips-on-digitalocean"},"floating IPs"),". On demand IP address remapping eliminates the propagation and caching issues inherent in DNS changes by providing a static IP address that can be easily remapped when needed. The domain name can remain associated with the same IP address, while the IP address itself is moved between servers."),(0,r.kt)("p",null,"This is how a highly available infrastructure using Floating IPs might look:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://assets.digitalocean.com/articles/high_availability/ha-diagram-animated.gif",alt:"Diagram 03: Floating IPs"})),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"In this article, we\u2019ve given an overview of load balancer concepts and how they work in general. To learn more about specific load balancing technologies, you might like to look at:"),(0,r.kt)("h3",{id:"digitaloceans-load-balancing-service"},"DigitalOcean\u2019s Load Balancing Service"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-create-your-first-digitalocean-load-balancer"},"How To Create Your First DigitalOcean Load Balancer")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-configure-ssl-passthrough-on-digitalocean-load-balancers"},"How To Configure SSL Passthrough on DigitalOcean Load Balancers")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-configure-ssl-termination-on-digitalocean-load-balancers"},"How To Configure SSL Termination on DigitalOcean Load Balancers")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.digitalocean.com/products/networking/load-balancers/how-to/tcp/"},"How To Balance TCP Traffic with DigitalOcean Load Balancers"))),(0,r.kt)("h3",{id:"haproxy"},"HAProxy"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/an-introduction-to-haproxy-and-load-balancing-concepts"},"An Introduction to HAProxy and Load Balancing Concepts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-highly-available-haproxy-servers-with-keepalived-and-floating-ips-on-ubuntu-14-04"},"How To Set Up Highly Available HAProxy Servers with Keepalived and Floating IPs on Ubuntu 14.04")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorial_series/load-balancing-wordpress-with-haproxy"},"Load Balancing WordPress with HAProxy"))),(0,r.kt)("h3",{id:"nginx"},"Nginx"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/understanding-nginx-http-proxying-load-balancing-buffering-and-caching"},"Understanding Nginx HTTP Proxying, Load Balancing, Buffering, and Caching")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-load-balancing-with-ssl-termination"},"How To Set Up Nginx Load Balancing with SSL Termination"))))}u.isMDXComponent=!0}}]);